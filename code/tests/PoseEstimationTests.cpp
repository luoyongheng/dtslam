#include <limits.h>
#include <opencv2/opencv.hpp>
#include <gtest/gtest.h>

#include "nvslam/EssentialEstimation.h"
#include "nvslam/EssentialUtils.h"
#include "nvslam/PnpEstimation.h"
#include "nvslam/ReprojectionError2D.h"
#include "nvslam/ReprojectionError3D.h"

using namespace nvslam;

TEST(PoseEstimationTests, refineEssentialNormalized)
{
	cv::FileStorage fs("C:/code/dslam/datasets/testData/refineEssentialIdeal.yml", cv::FileStorage::READ);

	std::vector<cv::Point3f> refXnPoints;
	std::vector<int> octaves;
	std::vector<cv::Point3f> dstXnPoints;
	cv::Matx33f essential;

	//float mOutlierThreshold = 0.00340916f;

	fs["refXnPoints"] >> refXnPoints;
	fs["dstXnPoints"] >> dstXnPoints;
	fs["octaves"] >> octaves;
	cv::Mat emat;
	fs["essential"] >> emat;
	essential = emat;

	int ransacInlierCount;
	std::vector<bool> ransacInliers;

//	EssentialRansac eransac;
//	eransac.setParams(mOutlierThreshold, 50, 50);
//	eransac.setData(&refXnPoints, &dstXnPoints, &octaves);
//	eransac.getInliers(essential, ransacInlierCount, ransacInliers);
//	std::cout << "Ransac inlier count=" <<ransacInlierCount << "\n";

	int inlierCount;
	std::vector<bool> inliers;

//	PoseEstimation estimator;
//	estimator.setOutlierThreshold(mOutlierThreshold);
//	estimator.refineEssentialNormalized(refXnPoints, octaves, dstXnPoints, octaves, essential, inlierCount, inliers);
//	std::cout << "Final inlier count=" <<inlierCount << "\n";
	ASSERT_GE(inlierCount, ransacInlierCount);
}

TEST(PoseEstimationTests, refineRotation)
{
	cv::FileStorage fs("C:/code/dslam/datasets/testData/refineRotation.yml", cv::FileStorage::READ);

	CameraModel camera;
	std::vector<cv::Point3f> featurePoints;
	std::vector<cv::Point2f> imagePoints;
	std::vector<int> octaves;
	cv::Matx33f rotation;
	int inlierCountBefore;

	//float mOutlierPixelThreshold = 3;

	fs["camera"] >> camera;
	fs["featurePoints"] >> featurePoints;
	fs["imagePoints"] >> imagePoints;
	fs["octaves"] >> octaves;
	cv::Mat rmat;
	fs["rotation"] >> rmat;
	rotation = rmat;
	fs["inlierCountBefore"] >> inlierCountBefore;

	//int inlierCount;
	std::vector<bool> inliers;

//	PoseEstimation estimator;
//	estimator.setCamera(&camera);
//	estimator.setOutlierThreshold(mOutlierPixelThreshold);
//	estimator.refineRotation3D(featurePoints, imagePoints, octaves, rotation, inlierCount, inliers);
//	std::cout << "Final inlier count=" <<inlierCount << "\n";
//	ASSERT_GE(inlierCount, inlierCountBefore);
}

TEST(EssentialTests, essentialCeres_vs_essentialOpenCV)
{
	cv::Matx33f refR(0.87243736, -0.17752759, 0.45534277,
				0.16317226, 0.98403841, 0.071015514,
				-0.460682, 0.01234272, 0.88747942);
	cv::Vec3f refT(2.9002225,  0.37218252,  -1.4185793);

	cv::Matx33f imgR(0.95122546, -0.11799946, 0.28503737,
				0.09777388, 0.99163812, 0.08422672,
				-0.29259261, -0.052249387, 0.95480865);
	cv::Vec3f imgT(1.8089061,  0.30606437,  -1.0704116);

	//Use opencv version
	FullPose3D relPoseA = FullPose3D::MakeRelativePose(FullPose3D(refR,refT), FullPose3D(imgR,imgT));
	cv::Matx33f essentialA = EssentialUtils::EssentialFromPose(relPoseA);

	//Use ceres version
	float relR[9];
	float relT[3];
	FullPose3D::MakeRelativePose(refR.val, refT.val, imgR.val, imgT.val, relR, relT);

	//Essential matrix
	float essential[9]; //img * essential * ref = 0
	EssentialUtils::EssentialFromPose(relR, relT, essential);

	for(int i=0; i<9; ++i)
		ASSERT_FLOAT_EQ(essentialA.val[i], essential[i]);
}


void PnPTests_syntheticScene()
{
	CameraModel camera;
	camera.init(1,1,0,0,640,480);
	camera.getDistortionModel().init(0,0);

	FullPose3D pose0(cv::Matx33f::eye(), cv::Vec3f(0,0,0));
	FullPose3D pose1(cv::Matx33f::eye(), cv::Vec3f(-1,0,0));
	FullPose3D truePose2(cv::Matx33f::eye(), cv::Vec3f(-0.5,-0.5,0.1));
	FullPose3D pose2(cvutils::RotationX(0.5f), cv::Vec3f(-0.6,-0.6,0.1));
	std::vector<float> Xv = {0.000000,0.000000,1.000000,0.000000,0.100000,1.000000,0.000000,0.200000,1.000000,0.000000,0.300000,1.000000,0.000000,0.400000,1.000000,0.000000,0.500000,1.000000,0.000000,0.600000,1.000000,0.000000,0.700000,1.000000,0.000000,0.800000,1.000000,0.000000,0.900000,1.000000,0.000000,1.000000,1.000000,0.100000,0.000000,1.000000,0.100000,0.100000,1.000000,0.100000,0.200000,1.000000,0.100000,0.300000,1.000000,0.100000,0.400000,1.000000,0.100000,0.500000,1.000000,0.100000,0.600000,1.000000,0.100000,0.700000,1.000000,0.100000,0.800000,1.000000,0.100000,0.900000,1.000000,0.100000,1.000000,1.000000,0.200000,0.000000,1.000000,0.200000,0.100000,1.000000,0.200000,0.200000,1.000000,0.200000,0.300000,1.000000,0.200000,0.400000,1.000000,0.200000,0.500000,1.000000,0.200000,0.600000,1.000000,0.200000,0.700000,1.000000,0.200000,0.800000,1.000000,0.200000,0.900000,1.000000,0.200000,1.000000,1.000000,0.300000,0.000000,1.000000,0.300000,0.100000,1.000000,0.300000,0.200000,1.000000,0.300000,0.300000,1.000000,0.300000,0.400000,1.000000,0.300000,0.500000,1.000000,0.300000,0.600000,1.000000,0.300000,0.700000,1.000000,0.300000,0.800000,1.000000,0.300000,0.900000,1.000000,0.300000,1.000000,1.000000,0.400000,0.000000,1.000000,0.400000,0.100000,1.000000,0.400000,0.200000,1.000000,0.400000,0.300000,1.000000,0.400000,0.400000,1.000000,0.400000,0.500000,1.000000,0.400000,0.600000,1.000000,0.400000,0.700000,1.000000,0.400000,0.800000,1.000000,0.400000,0.900000,1.000000,0.400000,1.000000,1.000000,0.500000,0.000000,1.000000,0.500000,0.100000,1.000000,0.500000,0.200000,1.000000,0.500000,0.300000,1.000000,0.500000,0.400000,1.000000,0.500000,0.500000,1.000000,0.500000,0.600000,1.000000,0.500000,0.700000,1.000000,0.500000,0.800000,1.000000,0.500000,0.900000,1.000000,0.500000,1.000000,1.000000,0.600000,0.000000,1.000000,0.600000,0.100000,1.000000,0.600000,0.200000,1.000000,0.600000,0.300000,1.000000,0.600000,0.400000,1.000000,0.600000,0.500000,1.000000,0.600000,0.600000,1.000000,0.600000,0.700000,1.000000,0.600000,0.800000,1.000000,0.600000,0.900000,1.000000,0.600000,1.000000,1.000000,0.700000,0.000000,1.000000,0.700000,0.100000,1.000000,0.700000,0.200000,1.000000,0.700000,0.300000,1.000000,0.700000,0.400000,1.000000,0.700000,0.500000,1.000000,0.700000,0.600000,1.000000,0.700000,0.700000,1.000000,0.700000,0.800000,1.000000,0.700000,0.900000,1.000000,0.700000,1.000000,1.000000,0.800000,0.000000,1.000000,0.800000,0.100000,1.000000,0.800000,0.200000,1.000000,0.800000,0.300000,1.000000,0.800000,0.400000,1.000000,0.800000,0.500000,1.000000,0.800000,0.600000,1.000000,0.800000,0.700000,1.000000,0.800000,0.800000,1.000000,0.800000,0.900000,1.000000,0.800000,1.000000,1.000000,0.900000,0.000000,1.000000,0.900000,0.100000,1.000000,0.900000,0.200000,1.000000,0.900000,0.300000,1.000000,0.900000,0.400000,1.000000,0.900000,0.500000,1.000000,0.900000,0.600000,1.000000,0.900000,0.700000,1.000000,0.900000,0.800000,1.000000,0.900000,0.900000,1.000000,0.900000,1.000000,1.000000,1.000000,0.000000,1.000000,1.000000,0.100000,1.000000,1.000000,0.200000,1.000000,1.000000,0.300000,1.000000,1.000000,0.400000,1.000000,1.000000,0.500000,1.000000,1.000000,0.600000,1.000000,1.000000,0.700000,1.000000,1.000000,0.800000,1.000000,1.000000,0.900000,1.000000,1.000000,1.000000,1.000000};
	std::vector<float> m0v = {0.000000,0.000000,0.000000,0.100000,0.000000,0.200000,0.000000,0.300000,0.000000,0.400000,0.000000,0.500000,0.000000,0.600000,0.000000,0.700000,0.000000,0.800000,0.000000,0.900000,0.000000,1.000000,0.100000,0.000000,0.100000,0.100000,0.100000,0.200000,0.100000,0.300000,0.100000,0.400000,0.100000,0.500000,0.100000,0.600000,0.100000,0.700000,0.100000,0.800000,0.100000,0.900000,0.100000,1.000000,0.200000,0.000000,0.200000,0.100000,0.200000,0.200000,0.200000,0.300000,0.200000,0.400000,0.200000,0.500000,0.200000,0.600000,0.200000,0.700000,0.200000,0.800000,0.200000,0.900000,0.200000,1.000000,0.300000,0.000000,0.300000,0.100000,0.300000,0.200000,0.300000,0.300000,0.300000,0.400000,0.300000,0.500000,0.300000,0.600000,0.300000,0.700000,0.300000,0.800000,0.300000,0.900000,0.300000,1.000000,0.400000,0.000000,0.400000,0.100000,0.400000,0.200000,0.400000,0.300000,0.400000,0.400000,0.400000,0.500000,0.400000,0.600000,0.400000,0.700000,0.400000,0.800000,0.400000,0.900000,0.400000,1.000000,0.500000,0.000000,0.500000,0.100000,0.500000,0.200000,0.500000,0.300000,0.500000,0.400000,0.500000,0.500000,0.500000,0.600000,0.500000,0.700000,0.500000,0.800000,0.500000,0.900000,0.500000,1.000000,0.600000,0.000000,0.600000,0.100000,0.600000,0.200000,0.600000,0.300000,0.600000,0.400000,0.600000,0.500000,0.600000,0.600000,0.600000,0.700000,0.600000,0.800000,0.600000,0.900000,0.600000,1.000000,0.700000,0.000000,0.700000,0.100000,0.700000,0.200000,0.700000,0.300000,0.700000,0.400000,0.700000,0.500000,0.700000,0.600000,0.700000,0.700000,0.700000,0.800000,0.700000,0.900000,0.700000,1.000000,0.800000,0.000000,0.800000,0.100000,0.800000,0.200000,0.800000,0.300000,0.800000,0.400000,0.800000,0.500000,0.800000,0.600000,0.800000,0.700000,0.800000,0.800000,0.800000,0.900000,0.800000,1.000000,0.900000,0.000000,0.900000,0.100000,0.900000,0.200000,0.900000,0.300000,0.900000,0.400000,0.900000,0.500000,0.900000,0.600000,0.900000,0.700000,0.900000,0.800000,0.900000,0.900000,0.900000,1.000000,1.000000,0.000000,1.000000,0.100000,1.000000,0.200000,1.000000,0.300000,1.000000,0.400000,1.000000,0.500000,1.000000,0.600000,1.000000,0.700000,1.000000,0.800000,1.000000,0.900000,1.000000,1.000000};
	std::vector<float> m1v = {-1.000000,0.000000,-1.000000,0.100000,-1.000000,0.200000,-1.000000,0.300000,-1.000000,0.400000,-1.000000,0.500000,-1.000000,0.600000,-1.000000,0.700000,-1.000000,0.800000,-1.000000,0.900000,-1.000000,1.000000,-0.900000,0.000000,-0.900000,0.100000,-0.900000,0.200000,-0.900000,0.300000,-0.900000,0.400000,-0.900000,0.500000,-0.900000,0.600000,-0.900000,0.700000,-0.900000,0.800000,-0.900000,0.900000,-0.900000,1.000000,-0.800000,0.000000,-0.800000,0.100000,-0.800000,0.200000,-0.800000,0.300000,-0.800000,0.400000,-0.800000,0.500000,-0.800000,0.600000,-0.800000,0.700000,-0.800000,0.800000,-0.800000,0.900000,-0.800000,1.000000,-0.700000,0.000000,-0.700000,0.100000,-0.700000,0.200000,-0.700000,0.300000,-0.700000,0.400000,-0.700000,0.500000,-0.700000,0.600000,-0.700000,0.700000,-0.700000,0.800000,-0.700000,0.900000,-0.700000,1.000000,-0.600000,0.000000,-0.600000,0.100000,-0.600000,0.200000,-0.600000,0.300000,-0.600000,0.400000,-0.600000,0.500000,-0.600000,0.600000,-0.600000,0.700000,-0.600000,0.800000,-0.600000,0.900000,-0.600000,1.000000,-0.500000,0.000000,-0.500000,0.100000,-0.500000,0.200000,-0.500000,0.300000,-0.500000,0.400000,-0.500000,0.500000,-0.500000,0.600000,-0.500000,0.700000,-0.500000,0.800000,-0.500000,0.900000,-0.500000,1.000000,-0.400000,0.000000,-0.400000,0.100000,-0.400000,0.200000,-0.400000,0.300000,-0.400000,0.400000,-0.400000,0.500000,-0.400000,0.600000,-0.400000,0.700000,-0.400000,0.800000,-0.400000,0.900000,-0.400000,1.000000,-0.300000,0.000000,-0.300000,0.100000,-0.300000,0.200000,-0.300000,0.300000,-0.300000,0.400000,-0.300000,0.500000,-0.300000,0.600000,-0.300000,0.700000,-0.300000,0.800000,-0.300000,0.900000,-0.300000,1.000000,-0.200000,0.000000,-0.200000,0.100000,-0.200000,0.200000,-0.200000,0.300000,-0.200000,0.400000,-0.200000,0.500000,-0.200000,0.600000,-0.200000,0.700000,-0.200000,0.800000,-0.200000,0.900000,-0.200000,1.000000,-0.100000,0.000000,-0.100000,0.100000,-0.100000,0.200000,-0.100000,0.300000,-0.100000,0.400000,-0.100000,0.500000,-0.100000,0.600000,-0.100000,0.700000,-0.100000,0.800000,-0.100000,0.900000,-0.100000,1.000000,0.000000,0.000000,0.000000,0.100000,0.000000,0.200000,0.000000,0.300000,0.000000,0.400000,0.000000,0.500000,0.000000,0.600000,0.000000,0.700000,0.000000,0.800000,0.000000,0.900000,0.000000,1.000000};
	std::vector<float> m2v = {-0.500000,-0.500000,-0.500000,-0.400000,-0.500000,-0.300000,-0.500000,-0.200000,-0.500000,-0.100000,-0.500000,0.000000,-0.500000,0.100000,-0.500000,0.200000,-0.500000,0.300000,-0.500000,0.400000,-0.500000,0.500000,-0.400000,-0.500000,-0.400000,-0.400000,-0.400000,-0.300000,-0.400000,-0.200000,-0.400000,-0.100000,-0.400000,0.000000,-0.400000,0.100000,-0.400000,0.200000,-0.400000,0.300000,-0.400000,0.400000,-0.400000,0.500000,-0.300000,-0.500000,-0.300000,-0.400000,-0.300000,-0.300000,-0.300000,-0.200000,-0.300000,-0.100000,-0.300000,0.000000,-0.300000,0.100000,-0.300000,0.200000,-0.300000,0.300000,-0.300000,0.400000,-0.300000,0.500000,-0.200000,-0.500000,-0.200000,-0.400000,-0.200000,-0.300000,-0.200000,-0.200000,-0.200000,-0.100000,-0.200000,0.000000,-0.200000,0.100000,-0.200000,0.200000,-0.200000,0.300000,-0.200000,0.400000,-0.200000,0.500000,-0.100000,-0.500000,-0.100000,-0.400000,-0.100000,-0.300000,-0.100000,-0.200000,-0.100000,-0.100000,-0.100000,0.000000,-0.100000,0.100000,-0.100000,0.200000,-0.100000,0.300000,-0.100000,0.400000,-0.100000,0.500000,0.000000,-0.500000,0.000000,-0.400000,0.000000,-0.300000,0.000000,-0.200000,0.000000,-0.100000,0.000000,0.000000,0.000000,0.100000,0.000000,0.200000,0.000000,0.300000,0.000000,0.400000,0.000000,0.500000,0.100000,-0.500000,0.100000,-0.400000,0.100000,-0.300000,0.100000,-0.200000,0.100000,-0.100000,0.100000,0.000000,0.100000,0.100000,0.100000,0.200000,0.100000,0.300000,0.100000,0.400000,0.100000,0.500000,0.200000,-0.500000,0.200000,-0.400000,0.200000,-0.300000,0.200000,-0.200000,0.200000,-0.100000,0.200000,0.000000,0.200000,0.100000,0.200000,0.200000,0.200000,0.300000,0.200000,0.400000,0.200000,0.500000,0.300000,-0.500000,0.300000,-0.400000,0.300000,-0.300000,0.300000,-0.200000,0.300000,-0.100000,0.300000,0.000000,0.300000,0.100000,0.300000,0.200000,0.300000,0.300000,0.300000,0.400000,0.300000,0.500000,0.400000,-0.500000,0.400000,-0.400000,0.400000,-0.300000,0.400000,-0.200000,0.400000,-0.100000,0.400000,0.000000,0.400000,0.100000,0.400000,0.200000,0.400000,0.300000,0.400000,0.400000,0.400000,0.500000,0.500000,-0.500000,0.500000,-0.400000,0.500000,-0.300000,0.500000,-0.200000,0.500000,-0.100000,0.500000,0.000000,0.500000,0.100000,0.500000,0.200000,0.500000,0.300000,0.500000,0.400000,0.500000,0.500000};
	cv::Mat3f X(1,Xv.size()/3,(cv::Vec3f*)Xv.data());
	cv::Mat2f m0(1,m0v.size()/2,(cv::Vec2f*)m0v.data());
	cv::Mat2f m1(1,m1v.size()/2,(cv::Vec2f*)m1v.data());
	cv::Mat2f m2(1,m2v.size()/2,(cv::Vec2f*)m2v.data());

	std::vector<SlamKeyFrame> frames;
	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose0)));

	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose1)));

	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose2)));

	std::vector<FeatureMatch> matches2D;
	std::vector<FeatureMatch> matches3D;

	std::vector<std::unique_ptr<SlamFeature>> features;
	for(int i=0,end=X.cols; i!=end; ++i)
	{
		features.emplace_back(new SlamFeature());
		auto &feature = *features.back();
		feature.set2DSection(NULL);
		feature.setPosition(X(0,i));

		feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[0], m0(0,i), cvutils::PointToHomogenousUnitNorm(m0(0,i)), 0)));
		frames[0].getMeasurements().push_back(feature.getMeasurements().back().get());

		feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[1], m1(0,i), cvutils::PointToHomogenousUnitNorm(m1(0,i)), 0)));
		frames[1].getMeasurements().push_back(feature.getMeasurements().back().get());

		//feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[2], m2(0,i), cvutils::PointToHomogenousUnitNorm(m2(0,i)), 0)));
		//frames[2].getMeasurements().push_back(feature.getMeasurements().back().get());

		SlamFeatureMeasurement m2i(&feature, &frames[2], m2(0,i), cvutils::PointToHomogenousUnitNorm(m2(0,i)), 0);
		//matches3D.push_back(FeatureMatch(feature.getMeasurements()[0].get(), &frames[2], 0, m2(0,i), cvutils::PointToHomogenousUnitNorm(m2(0,i))));
		if(i<50)
		{
			matches2D.push_back(FeatureMatch(feature.getMeasurements()[0].get(), m2i));
		}
		else
		{
			matches2D.push_back(FeatureMatch(feature.getMeasurements()[1].get(), m2i));
		}
	}

	auto f = cv::Formatter::get(cv::Formatter::FMT_MATLAB);
	f->set32fPrecision(2);

	NVSLAM_LOG << "Before R=" << (cv::Mat1f)pose2.getRotationRef() << "\n";
	NVSLAM_LOG << "Before t=" << pose2.getTranslationRef() << "\n";

	std::vector<MatchReprojectionErrors> errors3D;
	std::vector<MatchReprojectionErrors> errors2D;
	int inlierCount;
	PnPRefiner refiner;
	refiner.setCamera(&camera);
	refiner.setOutlierThreshold(3);
	refiner.refinePose(matches3D,matches2D,pose2.getRotationRef(),pose2.getTranslationRef(), inlierCount, errors3D, errors2D);

	NVSLAM_LOG << "After R=" << f->format((cv::Mat1f)pose2.getRotationRef()) << "\n";
	NVSLAM_LOG << "After t=" << f->format((cv::Mat1f)pose2.getTranslationRef()) << "\n";
}

TEST(PnPTests, syntheticScene)
{
	PnPTests_syntheticScene();
}

void PnPTests_syntheticNoiseScene()
{
	CameraModel_<RadialCameraDistortionModel> camera;
	camera.init(1759.95830,   1758.22390, 963.80029,   541.04811, 1920, 1080);
	camera.getDistortionModel().init(0.16262,-0.67445);

	FullPose3D pose0(cv::Matx33f::eye(), cv::Vec3f(0,0,0));
	FullPose3D pose1(cv::Matx33f::eye(), cv::Vec3f(-0.1,0,0));
	FullPose3D truePose2(cv::Matx33f::eye(), cv::Vec3f(-0.05,-0.05,0));
	FullPose3D pose2(cvutils::RotationX(0.50f), cv::Vec3f(-0.06,-0.06,0.1));
	std::vector<float> Xv = {-0.100000,-0.100000,2.798482,-0.100000,-0.090000,2.014500,-0.100000,-0.080000,3.353150,-0.100000,-0.070000,3.687618,-0.100000,-0.060000,2.277719,-0.100000,-0.050000,3.994435,-0.100000,-0.040000,3.492306,-0.100000,-0.030000,2.886525,-0.100000,-0.020000,3.363378,-0.100000,-0.010000,3.948490,-0.100000,0.000000,1.537966,-0.100000,0.010000,2.299885,-0.100000,0.020000,2.247268,-0.100000,0.030000,3.891759,-0.100000,0.040000,1.322652,-0.100000,0.050000,3.433787,-0.100000,0.060000,2.378578,-0.100000,0.070000,2.876854,-0.100000,0.080000,3.361586,-0.100000,0.090000,3.774106,-0.100000,0.100000,3.783341,-0.090000,-0.100000,3.970204,-0.090000,-0.090000,3.761017,-0.090000,-0.080000,2.293384,-0.090000,-0.070000,3.333013,-0.090000,-0.060000,2.257670,-0.090000,-0.050000,2.991558,-0.090000,-0.040000,1.586320,-0.090000,-0.030000,1.520895,-0.090000,-0.020000,3.869369,-0.090000,-0.010000,3.955110,-0.090000,0.000000,3.824133,-0.090000,0.010000,1.904420,-0.090000,0.020000,3.779864,-0.090000,0.030000,2.591752,-0.090000,0.040000,3.580812,-0.090000,0.050000,1.818835,-0.090000,0.060000,3.827731,-0.090000,0.070000,2.559745,-0.090000,0.080000,2.444528,-0.090000,0.090000,1.807949,-0.090000,0.100000,2.871150,-0.080000,-0.100000,3.866179,-0.080000,-0.090000,2.313240,-0.080000,-0.080000,3.617269,-0.080000,-0.070000,3.104229,-0.080000,-0.060000,2.431847,-0.080000,-0.050000,2.168199,-0.080000,-0.040000,2.177650,-0.080000,-0.030000,1.499974,-0.080000,-0.020000,2.155230,-0.080000,-0.010000,1.734626,-0.080000,0.000000,3.431699,-0.080000,0.010000,1.951543,-0.080000,0.020000,2.684025,-0.080000,0.030000,1.878231,-0.080000,0.040000,3.418093,-0.080000,0.050000,1.553643,-0.080000,0.060000,1.062818,-0.080000,0.070000,2.143157,-0.080000,0.080000,1.385424,-0.080000,0.090000,1.076985,-0.080000,0.100000,2.266225,-0.070000,-0.100000,3.557213,-0.070000,-0.090000,1.532400,-0.070000,-0.080000,1.339492,-0.070000,-0.070000,1.401857,-0.070000,-0.060000,1.458524,-0.070000,-0.050000,2.571350,-0.070000,-0.040000,2.495321,-0.070000,-0.030000,2.696793,-0.070000,-0.020000,2.329081,-0.070000,-0.010000,2.255122,-0.070000,0.000000,3.394713,-0.070000,0.010000,2.162968,-0.070000,0.020000,2.733565,-0.070000,0.030000,2.066584,-0.070000,0.040000,2.366660,-0.070000,0.050000,2.190661,-0.070000,0.060000,1.444065,-0.070000,0.070000,1.477649,-0.070000,0.080000,1.062210,-0.070000,0.090000,2.399149,-0.070000,0.100000,2.592505,-0.060000,-0.100000,2.640339,-0.060000,-0.090000,1.126517,-0.060000,-0.080000,3.434680,-0.060000,-0.070000,2.961231,-0.060000,-0.060000,2.778877,-0.060000,-0.050000,3.162136,-0.060000,-0.040000,2.190939,-0.060000,-0.030000,1.644815,-0.060000,-0.020000,2.880106,-0.060000,-0.010000,3.460283,-0.060000,0.000000,2.711047,-0.060000,0.010000,3.113407,-0.060000,0.020000,3.170106,-0.060000,0.030000,2.917215,-0.060000,0.040000,2.637687,-0.060000,0.050000,1.382589,-0.060000,0.060000,1.050272,-0.060000,0.070000,2.723314,-0.060000,0.080000,2.213937,-0.060000,0.090000,3.753775,-0.060000,0.100000,1.348866,-0.050000,-0.100000,2.657853,-0.050000,-0.090000,1.735275,-0.050000,-0.080000,1.528109,-0.050000,-0.070000,3.782528,-0.050000,-0.060000,1.370611,-0.050000,-0.050000,3.406413,-0.050000,-0.040000,2.019532,-0.050000,-0.030000,1.319075,-0.050000,-0.020000,2.068677,-0.050000,-0.010000,3.592534,-0.050000,0.000000,2.080671,-0.050000,0.010000,3.796143,-0.050000,0.020000,3.258513,-0.050000,0.030000,2.931795,-0.050000,0.040000,3.723774,-0.050000,0.050000,2.002912,-0.050000,0.060000,2.198158,-0.050000,0.070000,3.089986,-0.050000,0.080000,1.732471,-0.050000,0.090000,1.948692,-0.050000,0.100000,3.121891,-0.040000,-0.100000,2.587884,-0.040000,-0.090000,3.940151,-0.040000,-0.080000,2.096440,-0.040000,-0.070000,2.859522,-0.040000,-0.060000,3.640804,-0.040000,-0.050000,2.598802,-0.040000,-0.040000,1.374143,-0.040000,-0.030000,3.431132,-0.040000,-0.020000,2.326960,-0.040000,-0.010000,2.287046,-0.040000,0.000000,1.436471,-0.040000,0.010000,1.664129,-0.040000,0.020000,2.135952,-0.040000,0.030000,2.886217,-0.040000,0.040000,3.079359,-0.040000,0.050000,2.040923,-0.040000,0.060000,3.137226,-0.040000,0.070000,1.647930,-0.040000,0.080000,2.842946,-0.040000,0.090000,2.426387,-0.040000,0.100000,2.022535,-0.030000,-0.100000,3.234606,-0.030000,-0.090000,3.009023,-0.030000,-0.080000,2.671457,-0.030000,-0.070000,3.183439,-0.030000,-0.060000,3.805732,-0.030000,-0.050000,1.790550,-0.030000,-0.040000,1.567857,-0.030000,-0.030000,1.811110,-0.030000,-0.020000,1.444817,-0.030000,-0.010000,1.493083,-0.030000,0.000000,3.398078,-0.030000,0.010000,1.678729,-0.030000,0.020000,1.200544,-0.030000,0.030000,1.600469,-0.030000,0.040000,3.751470,-0.030000,0.050000,1.900598,-0.030000,0.060000,2.558642,-0.030000,0.070000,3.947928,-0.030000,0.080000,2.563301,-0.030000,0.090000,2.702758,-0.030000,0.100000,1.669081,-0.020000,-0.100000,2.111923,-0.020000,-0.090000,2.517519,-0.020000,-0.080000,2.368185,-0.020000,-0.070000,3.781098,-0.020000,-0.060000,3.140817,-0.020000,-0.050000,3.012864,-0.020000,-0.040000,1.493420,-0.020000,-0.030000,1.423962,-0.020000,-0.020000,2.023516,-0.020000,-0.010000,1.043481,-0.020000,0.000000,2.635291,-0.020000,0.010000,2.116048,-0.020000,0.020000,3.840602,-0.020000,0.030000,3.229735,-0.020000,0.040000,1.343564,-0.020000,0.050000,1.973576,-0.020000,0.060000,2.837414,-0.020000,0.070000,2.442466,-0.020000,0.080000,1.544169,-0.020000,0.090000,1.632083,-0.020000,0.100000,1.535002,-0.010000,-0.100000,3.967138,-0.010000,-0.090000,2.533695,-0.010000,-0.080000,3.999790,-0.010000,-0.070000,1.688543,-0.010000,-0.060000,3.985377,-0.010000,-0.050000,3.446149,-0.010000,-0.040000,1.507980,-0.010000,-0.030000,3.383013,-0.010000,-0.020000,2.128979,-0.010000,-0.010000,2.512138,-0.010000,0.000000,1.567559,-0.010000,0.010000,3.013174,-0.010000,0.020000,3.329411,-0.010000,0.030000,1.420748,-0.010000,0.040000,1.095672,-0.010000,0.050000,2.696682,-0.010000,0.060000,3.084899,-0.010000,0.070000,3.252678,-0.010000,0.080000,3.058972,-0.010000,0.090000,2.493870,-0.010000,0.100000,2.322476,0.000000,-0.100000,3.769447,0.000000,-0.090000,1.986225,0.000000,-0.080000,2.618707,0.000000,-0.070000,2.695265,0.000000,-0.060000,2.045382,0.000000,-0.050000,3.897523,0.000000,-0.040000,2.491046,0.000000,-0.030000,3.644576,0.000000,-0.020000,2.475299,0.000000,-0.010000,3.140876,0.000000,0.000000,2.137617,0.000000,0.010000,3.659367,0.000000,0.020000,3.233333,0.000000,0.030000,3.603933,0.000000,0.040000,1.746087,0.000000,0.050000,3.798049,0.000000,0.060000,1.073141,0.000000,0.070000,3.350485,0.000000,0.080000,1.463978,0.000000,0.090000,1.219765,0.000000,0.100000,3.566772,0.010000,-0.100000,2.626813,0.010000,-0.090000,2.557344,0.010000,-0.080000,1.424682,0.010000,-0.070000,1.200686,0.010000,-0.060000,1.624787,0.010000,-0.050000,2.033520,0.010000,-0.040000,2.713106,0.010000,-0.030000,3.500932,0.010000,-0.020000,3.844095,0.010000,-0.010000,2.638580,0.010000,0.000000,3.678475,0.010000,0.010000,3.408265,0.010000,0.020000,1.430098,0.010000,0.030000,2.228188,0.010000,0.040000,1.525626,0.010000,0.050000,2.549987,0.010000,0.060000,1.076671,0.010000,0.070000,3.347789,0.010000,0.080000,2.913646,0.010000,0.090000,2.592468,0.010000,0.100000,1.399181,0.020000,-0.100000,1.820860,0.020000,-0.090000,3.899543,0.020000,-0.080000,2.552987,0.020000,-0.070000,2.494455,0.020000,-0.060000,1.856038,0.020000,-0.050000,1.962448,0.020000,-0.040000,3.780781,0.020000,-0.030000,3.447513,0.020000,-0.020000,3.493980,0.020000,-0.010000,3.782191,0.020000,0.000000,3.289743,0.020000,0.010000,3.135823,0.020000,0.020000,1.035151,0.020000,0.030000,2.127386,0.020000,0.040000,3.814493,0.020000,0.050000,2.535074,0.020000,0.060000,2.130524,0.020000,0.070000,2.745085,0.020000,0.080000,1.231219,0.020000,0.090000,2.270647,0.020000,0.100000,3.259524,0.030000,-0.100000,2.667303,0.030000,-0.090000,1.438692,0.030000,-0.080000,1.583645,0.030000,-0.070000,3.836401,0.030000,-0.060000,3.320476,0.030000,-0.050000,3.336596,0.030000,-0.040000,2.646331,0.030000,-0.030000,3.073053,0.030000,-0.020000,2.251782,0.030000,-0.010000,3.124792,0.030000,0.000000,2.989104,0.030000,0.010000,1.161765,0.030000,0.020000,3.368711,0.030000,0.030000,1.871973,0.030000,0.040000,1.330342,0.030000,0.050000,3.653779,0.030000,0.060000,2.745956,0.030000,0.070000,2.874413,0.030000,0.080000,1.348697,0.030000,0.090000,1.710764,0.030000,0.100000,3.978354,0.040000,-0.100000,3.563201,0.040000,-0.090000,3.730696,0.040000,-0.080000,3.005443,0.040000,-0.070000,3.344704,0.040000,-0.060000,3.736834,0.040000,-0.050000,1.593550,0.040000,-0.040000,3.150996,0.040000,-0.030000,1.640197,0.040000,-0.020000,3.129849,0.040000,-0.010000,3.194344,0.040000,0.000000,2.333636,0.040000,0.010000,3.597399,0.040000,0.020000,3.317271,0.040000,0.030000,1.582865,0.040000,0.040000,2.287111,0.040000,0.050000,1.228793,0.040000,0.060000,1.517528,0.040000,0.070000,2.752910,0.040000,0.080000,1.981410,0.040000,0.090000,3.475269,0.040000,0.100000,3.227962,0.050000,-0.100000,1.022543,0.050000,-0.090000,3.306445,0.050000,-0.080000,1.477473,0.050000,-0.070000,2.752049,0.050000,-0.060000,3.957668,0.050000,-0.050000,1.029506,0.050000,-0.040000,2.290109,0.050000,-0.030000,2.348166,0.050000,-0.020000,1.215419,0.050000,-0.010000,2.467162,0.050000,0.000000,1.261013,0.050000,0.010000,3.187767,0.050000,0.020000,1.996924,0.050000,0.030000,2.370194,0.050000,0.040000,2.426099,0.050000,0.050000,2.430989,0.050000,0.060000,2.133121,0.050000,0.070000,3.997867,0.050000,0.080000,2.948227,0.050000,0.090000,1.179852,0.050000,0.100000,1.542229,0.060000,-0.100000,2.147583,0.060000,-0.090000,2.517782,0.060000,-0.080000,3.687980,0.060000,-0.070000,1.853828,0.060000,-0.060000,2.736883,0.060000,-0.050000,3.978109,0.060000,-0.040000,3.801282,0.060000,-0.030000,2.625252,0.060000,-0.020000,3.200326,0.060000,-0.010000,3.722859,0.060000,0.000000,3.795443,0.060000,0.010000,1.841560,0.060000,0.020000,3.208959,0.060000,0.030000,2.174932,0.060000,0.040000,3.348119,0.060000,0.050000,1.064035,0.060000,0.060000,1.254968,0.060000,0.070000,1.728247,0.060000,0.080000,1.841673,0.060000,0.090000,1.841010,0.060000,0.100000,1.981592,0.070000,-0.100000,3.095119,0.070000,-0.090000,1.946259,0.070000,-0.080000,3.692520,0.070000,-0.070000,2.831354,0.070000,-0.060000,1.616340,0.070000,-0.050000,3.842251,0.070000,-0.040000,2.726377,0.070000,-0.030000,1.424034,0.070000,-0.020000,1.980412,0.070000,-0.010000,2.057830,0.070000,0.000000,2.714767,0.070000,0.010000,3.081173,0.070000,0.020000,2.375530,0.070000,0.030000,1.886454,0.070000,0.040000,3.271355,0.070000,0.050000,3.953097,0.070000,0.060000,2.354082,0.070000,0.070000,1.636899,0.070000,0.080000,2.975699,0.070000,0.090000,1.482768,0.070000,0.100000,3.107941,0.080000,-0.100000,2.733217,0.080000,-0.090000,1.852984,0.080000,-0.080000,1.102592,0.080000,-0.070000,1.735286,0.080000,-0.060000,2.970944,0.080000,-0.050000,1.757556,0.080000,-0.040000,2.402700,0.080000,-0.030000,3.439003,0.080000,-0.020000,1.934551,0.080000,-0.010000,1.552451,0.080000,0.000000,2.679763,0.080000,0.010000,1.661621,0.080000,0.020000,1.585457,0.080000,0.030000,1.934275,0.080000,0.040000,2.958342,0.080000,0.050000,2.121249,0.080000,0.060000,3.476230,0.080000,0.070000,2.453772,0.080000,0.080000,3.606967,0.080000,0.090000,2.826467,0.080000,0.100000,3.537940,0.090000,-0.100000,1.108154,0.090000,-0.090000,2.307948,0.090000,-0.080000,3.679510,0.090000,-0.070000,1.908587,0.090000,-0.060000,2.012486,0.090000,-0.050000,2.497789,0.090000,-0.040000,1.908905,0.090000,-0.030000,1.568204,0.090000,-0.020000,2.916556,0.090000,-0.010000,2.939544,0.090000,0.000000,1.090391,0.090000,0.010000,2.763130,0.090000,0.020000,2.976462,0.090000,0.030000,1.212166,0.090000,0.040000,3.646881,0.090000,0.050000,3.126785,0.090000,0.060000,2.529043,0.090000,0.070000,3.454319,0.090000,0.080000,1.170460,0.090000,0.090000,1.794040,0.090000,0.100000,1.718506,0.100000,-0.100000,3.373311,0.100000,-0.090000,1.581985,0.100000,-0.080000,3.555613,0.100000,-0.070000,3.997359,0.100000,-0.060000,2.683511,0.100000,-0.050000,2.116902,0.100000,-0.040000,3.982658,0.100000,-0.030000,2.916764,0.100000,-0.020000,2.350452,0.100000,-0.010000,3.232838,0.100000,0.000000,1.743745,0.100000,0.010000,3.437463,0.100000,0.020000,2.380709,0.100000,0.030000,3.216818,0.100000,0.040000,2.645597,0.100000,0.050000,2.702251,0.100000,0.060000,3.664469,0.100000,0.070000,1.650084,0.100000,0.080000,2.837388,0.100000,0.090000,1.656498,0.100000,0.100000,3.294563};
	//These are noise-free
	std::vector<float> m0v = {900.884700,478.194522,876.373574,462.441607,911.301200,499.090227,916.065669,507.666804,886.499253,494.713195,919.734439,519.036897,913.397220,520.906750,902.815865,522.770812,911.465393,530.591446,919.222661,536.594740,849.288846,541.048110,887.252964,548.695299,885.458826,556.700962,918.572318,554.603130,830.597915,594.276553,912.537344,566.654324,889.779618,585.416746,902.606023,583.841883,911.433010,582.900649,917.158249,582.984579,917.271154,587.531393,923.896627,496.754400,921.677213,498.966545,894.703075,479.688891,916.267849,504.114866,893.615183,494.304149,910.842398,511.656053,863.887315,496.686104,859.588723,506.345154,922.860582,531.959363,923.748377,536.602283,922.376396,541.048110,880.597037,550.283805,921.890969,550.352115,902.671537,561.404281,919.560137,560.691024,876.668865,589.406754,922.413696,568.611982,901.900791,589.144720,898.978729,598.610493,876.120115,628.641878,908.612547,602.307395,927.376298,495.562989,902.908204,472.612022,924.870652,502.156837,918.435279,501.392843,905.887474,497.656302,898.843305,500.490003,899.127354,508.743509,869.885360,505.864718,898.456926,524.728368,882.603719,530.908541,922.768405,541.048110,891.634079,550.059997,911.334984,554.151511,888.812902,569.140669,922.604133,561.625890,873.123220,597.665428,831.141717,640.443991,898.078358,598.498129,862.065997,642.682146,832.816057,688.260154,901.640173,618.671684,929.160656,491.611685,883.334716,437.694326,871.735567,435.934972,875.849150,453.183644,879.279360,468.672993,915.880170,506.853185,914.420709,512.859014,918.111575,521.486529,910.896773,525.947715,909.161695,533.250289,927.506917,541.048110,906.833013,549.178272,918.726824,553.913552,904.173323,566.577341,911.735262,570.770235,907.548877,581.188094,878.431998,614.148821,880.366858,624.399320,847.637390,673.674880,912.431281,607.028891,916.262836,608.891834,923.793788,474.436316,869.927082,400.377062,933.051573,500.090224,928.134691,499.479250,925.794489,503.079763,930.402629,513.244153,915.594467,508.942565,899.582816,508.971016,927.132972,528.837716,933.281746,535.966699,924.846376,541.048110,929.881165,546.695726,930.487738,552.141351,927.599133,559.130851,923.761312,567.714457,887.384543,604.665144,863.153457,641.595758,925.017731,586.249839,916.087895,604.601944,935.665490,583.208720,885.421950,671.549944,930.682186,474.877177,913.060462,449.806425,906.179011,448.944919,940.534025,508.507438,899.563423,464.039834,937.965469,515.238749,920.219777,506.218058,897.067427,501.047850,921.257358,524.047707,939.304824,536.153845,921.503281,541.048110,940.618736,545.679852,936.793548,551.840161,933.783332,559.040536,940.167776,559.935490,919.856443,584.948651,923.759544,589.049654,935.318294,580.883609,912.982801,622.275965,918.622603,622.287808,935.607066,597.378990,936.589635,473.088511,945.931567,500.883104,930.210484,473.934702,939.178202,498.001919,944.463128,512.070952,936.708859,507.217194,912.555553,489.853874,943.282058,525.674602,933.545127,525.935436,933.017329,533.359954,914.786296,541.048110,921.492667,551.614592,930.839183,557.512422,939.407889,559.324382,940.937678,563.888191,929.301412,584.129211,941.358691,574.677335,921.064578,615.761904,939.033862,590.532152,934.778924,606.281834,928.977449,628.019419,947.474451,486.682277,946.250657,488.451096,944.032989,488.387255,947.213306,502.383289,949.926109,513.327094,934.307780,491.942366,930.119001,496.183981,934.644993,511.921545,927.253044,516.707290,928.435482,529.271458,948.262266,541.048110,932.346856,551.522256,919.814843,570.342843,930.806983,574.008903,949.725734,559.795691,936.015983,587.309654,943.162532,582.282950,950.425695,572.224745,943.198634,595.931718,944.261259,599.607438,932.147064,646.454885,947.127152,457.764574,949.815569,478.178884,948.934023,481.641642,954.490485,508.495904,952.592543,507.458003,952.116725,511.867982,940.227363,493.948718,939.078545,504.002036,946.404686,523.669649,930.065330,524.197253,950.443323,541.048110,947.165599,549.357259,954.635197,550.204171,952.901600,557.380034,937.597237,593.402571,945.962915,585.597601,951.393921,578.230537,949.386893,591.445286,940.994951,632.179568,942.222227,638.053703,940.853109,655.670945,959.363486,496.723791,956.852643,478.580904,959.399873,505.879466,953.374399,468.138793,959.384083,514.576982,958.693079,515.537222,952.127910,494.404600,958.597876,525.456250,955.533464,524.530752,956.794435,534.049159,952.572834,541.048110,957.959391,546.883253,958.514156,551.609959,951.411747,578.177114,947.733792,605.250770,957.273527,573.649766,958.094854,575.246991,958.389077,578.889271,958.046211,587.035375,956.741648,604.513284,956.220061,616.775701,963.800290,494.398706,963.800290,461.352942,963.800290,487.327256,963.800290,495.379452,963.800290,489.464521,963.800290,518.491849,963.800290,512.814227,963.800290,526.575288,963.800290,526.841806,963.800290,535.450223,963.800290,541.048110,963.800290,545.852837,963.800290,551.923791,963.800290,555.684151,963.800290,581.329576,963.800290,564.195171,963.800290,639.400858,963.800290,577.784401,963.800290,637.173441,963.800290,670.890402,963.800290,590.348932,970.501851,474.098545,970.683663,479.158803,976.159979,442.268038,978.466378,438.486666,974.634677,476.105851,972.455911,497.812656,970.287410,515.125203,968.827470,525.981432,968.378658,531.900399,970.470418,534.384556,968.584774,541.048110,968.964100,546.206831,976.107336,565.637946,971.699156,564.721356,975.337631,587.151994,970.702570,575.525502,980.154958,639.079417,969.057747,577.814043,969.841438,589.329669,970.590367,602.098579,976.389106,666.812213,983.141089,444.439414,972.827594,500.465277,977.590063,485.943375,977.913202,491.701595,982.768533,484.199458,981.738836,496.245941,973.110527,522.445986,974.010488,525.747905,973.874630,530.983698,973.106897,536.399392,974.500025,541.048110,975.025240,546.655054,997.808301,575.022607,980.346797,565.843412,973.028240,559.485823,977.686174,575.728610,980.324015,590.570432,976.624367,585.888146,992.409632,655.372702,979.306240,610.756120,974.600869,594.997786,983.599998,475.114125,1000.524905,430.982839,997.155897,452.187482,977.563744,508.965033,979.702301,509.275429,979.625211,514.699234,983.753126,514.470546,980.982026,523.883307,987.248807,525.431171,980.697296,535.421325,981.464317,541.048110,1009.252762,556.184003,979.473861,551.486860,992.007508,569.227530,1003.497456,593.925503,978.251337,565.109454,983.029972,579.469573,982.170913,583.870656,1002.973383,645.406748,994.678199,633.590549,977.073278,585.247803,983.560262,491.696863,982.672449,498.627598,987.227264,494.240336,984.849976,504.247462,982.640460,512.815705,1007.988858,485.866834,986.143072,518.727346,1006.727408,508.884500,986.293601,529.812538,985.839318,535.543783,993.968530,541.048110,983.369939,545.935701,985.022678,551.648847,1008.282737,574.377068,994.583806,571.801289,1021.115939,612.622067,1010.207302,610.590029,989.376177,585.761805,999.341376,612.060232,984.059872,586.587247,985.613130,595.526469,1050.017212,368.784195,990.418526,493.182502,1023.398856,445.784377,995.780767,496.319564,986.036485,514.390971,1049.340445,455.592253,1002.230367,510.334346,1001.279206,518.582921,1036.224515,512.106969,999.470431,533.921112,1033.601526,541.048110,991.406314,546.563874,1007.872218,558.659508,1000.930818,563.304472,1000.075749,570.039878,1000.003654,577.215796,1005.062362,590.513801,985.813160,571.835758,993.652980,588.765343,1038.473589,675.327588,1020.906908,655.148792,1012.993972,459.139439,1005.753465,478.180363,992.436585,502.904010,1020.784829,474.631664,1002.389422,502.497007,990.346598,518.947987,991.581357,522.545651,1004.028306,520.953924,996.798239,530.059633,992.166145,536.325127,991.623599,541.048110,1021.151747,550.597266,996.709454,552.007021,1012.359863,565.303969,995.342015,562.055204,1063.127805,623.739468,1048.005237,625.170075,1024.929162,612.294846,1021.165256,617.459355,1021.190488,627.048572,1017.119096,629.825212,1003.613958,484.227492,1027.134543,459.698604,997.168729,502.950333,1007.320616,497.570673,1040.059854,475.747186,995.866676,518.166121,1008.993797,515.248699,1050.352790,503.990737,1026.021688,523.288087,1023.679201,532.502410,1009.185535,541.048110,1003.787532,546.754944,1015.669062,555.853155,1029.123649,569.016246,1001.463344,562.548646,994.967385,563.288382,1016.146646,585.872198,1039.106857,616.280464,1005.209892,588.326732,1046.964100,647.867636,1003.449623,597.634195,1015.331680,476.697351,1039.835303,455.593018,1091.705453,413.268995,1044.986474,470.080205,1011.200201,505.533210,1043.946723,491.005953,1022.412772,511.770750,1004.745518,525.708781,1036.601655,522.865705,1054.532767,529.717727,1016.348592,541.048110,1048.566937,551.633499,1052.644017,563.237153,1036.613606,568.326195,1011.400437,564.824729,1030.195880,582.504459,1004.308411,571.399261,1021.197351,591.221045,1002.841151,580.050497,1013.628541,597.049650,1003.604950,590.754902,1107.058989,382.028643,1032.464575,472.451492,1006.855945,502.814133,1046.839110,476.526009,1042.543579,488.604317,1027.232270,505.842849,1046.813357,504.189773,1064.864362,507.393285,1018.118424,528.989309,1017.693205,535.065909,1109.222229,541.048110,1021.135192,547.412377,1017.024844,552.864133,1094.599218,584.604786,1007.238773,560.335077,1014.467045,569.168568,1026.449683,582.773212,1009.662928,576.683898,1099.351193,661.419061,1052.161302,629.322044,1056.060720,643.458676,1015.988116,488.911714,1075.177207,440.907668,1013.308703,501.480411,1007.834968,510.254212,1029.404440,501.724411,1046.975959,499.501259,1007.996075,523.387218,1024.152209,522.960377,1038.700474,526.082836,1018.248851,535.608620,1064.783331,541.048110,1015.006720,546.163707,1037.747987,555.823075,1018.520776,557.448078,1030.342147,567.638623,1028.947634,573.589681,1011.835816,569.841023,1070.551762,615.700500,1025.848075,590.637420,1070.156864,636.674696,1017.236258,594.431418};
	std::vector<float> m1v = {837.893661,478.156834,788.751018,462.353566,858.757617,499.072448,868.297428,507.655049,809.059540,494.671633,875.642028,519.030264,862.954562,520.898841,841.761880,522.760388,859.086202,530.587021,874.617510,536.593365,734.346737,541.048110,810.570035,548.702072,806.972366,556.715447,873.315627,554.607434,696.746994,594.406134,861.232804,566.664712,815.636689,585.453387,841.341795,583.866345,859.021565,582.918297,870.484880,582.998662,870.710950,587.546911,879.535303,496.741823,874.845682,498.953241,817.807837,479.638181,863.413732,504.100036,815.504950,494.264153,851.944720,511.641442,752.521266,496.612149,743.400986,506.282514,877.346063,531.956633,879.221932,536.601004,876.322961,541.048110,787.939726,550.294808,875.297231,550.355041,834.665725,561.417685,870.371757,560.697891,779.618728,589.469177,876.401837,568.620423,833.035892,589.176990,826.854664,598.652602,778.459794,628.754459,847.230579,602.340128,881.823509,495.550335,826.689500,472.560275,876.180769,502.144477,861.685174,501.375811,833.406323,497.626288,817.520742,500.454945,818.161242,508.715771,752.124511,505.803580,816.648655,524.714041,780.865173,530.895063,871.445858,541.048110,801.253754,550.069574,845.685659,554.159025,794.886165,569.172721,871.075895,561.633225,759.446598,597.757084,664.391241,640.752773,815.795845,598.548673,734.450589,642.880857,668.224393,688.690417,823.830409,618.732523,879.649980,491.596709,768.088049,437.537855,739.781004,435.731159,749.819803,453.025328,758.188904,468.550900,847.355845,506.833495,843.805149,512.841783,852.783654,521.476246,835.230342,525.937140,831.007564,533.244471,875.629756,541.048110,825.339272,549.184849,854.280089,553.920142,818.864211,566.599860,837.270974,570.790375,827.082367,581.219637,756.121144,614.274398,760.844286,624.535873,680.882959,674.054473,838.965470,607.072003,848.287397,608.929909,857.063155,474.403143,712.871591,400.039815,881.779215,500.077988,868.653945,499.462606,862.405457,503.062518,874.708449,513.234347,835.158319,508.919311,792.338057,508.930624,865.979239,528.832529,882.393439,535.965196,859.873459,541.048110,873.316327,546.697785,874.935586,552.145251,867.223904,559.138337,856.975844,567.727903,759.672061,604.775318,694.658157,641.876947,860.331341,586.271165,836.477699,604.646669,888.755366,583.219280,754.426921,671.777508,864.401457,474.847525,811.425810,449.713519,790.711987,448.825322,893.985788,508.500116,770.779926,463.916051,886.274338,515.231593,832.957498,506.191083,763.251497,500.977879,836.076930,524.035111,890.295523,536.152621,836.816227,541.048110,894.240046,545.680890,882.755498,551.843433,873.715786,559.047256,892.886260,559.939882,831.865204,584.983132,843.599447,589.081065,878.325638,580.896972,811.191327,622.359347,828.156420,622.354228,879.192940,597.397424,868.522445,473.059574,901.248087,500.875608,846.160204,473.891450,877.592621,497.986753,896.105412,512.064610,868.939852,507.202769,784.180648,489.778787,891.968769,525.670810,857.850943,525.927405,856.000659,533.355724,792.018356,541.048110,815.572126,551.625402,848.363885,557.522774,878.397231,559.330731,883.756712,563.895166,842.971589,584.158691,885.231616,574.687216,814.071768,615.838594,877.086952,590.549758,862.176350,606.313405,841.836814,628.079027,893.037663,486.668962,887.730371,488.436219,878.111317,488.368400,891.905116,502.373475,903.668118,513.322150,835.898770,491.903696,817.699050,496.138184,837.362944,511.899015,805.238806,516.678075,810.379929,529.258174,896.453777,541.048110,827.379577,551.531670,772.871063,570.392890,820.688691,574.041317,902.799343,559.799135,843.317185,587.342099,874.335029,582.299077,905.834107,572.229911,874.491786,595.953029,879.101584,599.627890,826.515486,646.547735,863.712068,457.723454,879.862442,478.156763,874.567222,481.618023,907.932629,508.490757,896.538431,507.450323,893.681478,511.860730,822.223205,493.902255,815.308942,503.961857,859.369550,523.660139,760.991524,524.164035,883.632446,541.048110,863.942101,549.361425,908.801279,550.205579,898.393975,557.383575,806.391922,593.465859,856.714811,585.623089,889.341268,578.240932,877.287472,591.464188,826.843940,632.262365,834.226648,638.132572,825.992407,655.774841,914.989443,496.718342,887.353368,478.562268,915.389837,505.875204,849.039527,468.090502,915.216077,514.573746,907.611797,515.533055,835.297032,494.365702,906.564032,525.453605,872.826521,524.523725,886.712253,534.047013,840.202216,541.048110,899.536666,546.884500,905.642631,551.611809,827.398370,578.211973,786.796876,605.349558,891.986819,573.658428,901.027734,575.253944,904.266065,578.896190,900.492373,587.044858,886.131331,604.532816,880.388357,616.802412,917.099572,494.393415,875.127234,461.321006,896.567264,487.314694,898.480541,495.369345,877.709958,489.444815,918.638452,518.489444,893.127602,512.806893,915.504072,526.573523,892.679966,526.838063,907.757005,535.449304,881.438531,541.048110,915.699799,545.853419,909.359815,551.925475,914.959270,555.685977,862.944488,581.350674,917.455300,564.197769,799.500105,639.531072,911.260551,577.789684,843.437905,637.243126,819.242575,671.021841,914.444589,590.355172,903.475067,474.086139,901.837802,479.146685,852.494884,442.207472,831.692615,438.398955,866.243928,476.074629,885.875523,497.799235,905.405961,515.120651,918.550881,525.979838,922.591364,531.899595,903.757980,534.383317,920.735806,541.048110,917.320812,546.207407,852.967706,565.653301,892.692022,564.727507,859.907370,587.177237,901.667443,575.532342,816.452267,639.183320,916.477720,577.818282,909.421710,589.336991,902.677949,602.110217,850.430208,666.890730,886.415101,444.411950,927.688774,500.462690,908.633043,485.935230,907.339888,491.693944,887.906193,484.183631,892.028162,496.234736,926.556808,522.444720,922.956154,525.746653,923.499719,530.982896,926.571327,536.399076,920.997502,541.048110,918.896047,546.655609,827.648037,575.052629,897.600104,565.848715,926.886020,559.487056,908.248385,575.733835,897.691368,590.580940,912.497403,585.893898,849.293264,655.442292,901.764973,610.769065,920.594049,595.002688,917.596812,475.108188,878.083797,430.949797,885.950985,452.165154,931.684152,508.963622,926.693418,509.273564,926.873326,514.697700,917.239371,514.468090,923.706821,523.882128,909.080103,525.429178,924.371324,535.420951,922.581235,541.048110,857.694358,556.191162,927.226532,551.487457,897.971342,569.232713,871.140252,593.944524,930.079542,565.110622,918.927189,579.472864,920.932154,583.874000,872.365125,645.442462,891.736329,633.610467,932.828720,585.249607,934.159579,491.695609,935.491394,498.626613,928.658575,494.238665,932.224849,504.246398,935.539379,512.815049,897.509093,485.859886,930.285023,518.726618,899.401914,508.880654,930.059206,529.812166,930.740696,535.543608,918.545238,541.048110,934.445080,545.935823,931.965770,551.649159,897.068060,574.381343,917.622165,571.803189,877.808825,612.637045,894.180164,610.599627,925.434826,585.763708,910.484330,612.066001,933.410105,586.588464,931.080019,595.528153,877.583368,368.784195,937.182054,493.182502,904.201724,445.784377,931.819813,496.319564,941.564095,514.390971,878.260135,455.592253,925.370213,510.334346,926.321374,518.582921,891.376065,512.106969,928.130149,533.921112,893.999054,541.048110,936.194266,546.563874,919.728362,558.659508,926.669762,563.304472,927.524831,570.039878,927.596926,577.215796,922.538218,590.513801,941.787420,571.835758,933.947600,588.765343,889.126991,675.327588,906.693672,655.148792,931.006761,459.145081,935.832921,478.183542,944.709880,502.904917,925.814126,474.637833,938.075311,502.498669,946.103114,518.948440,945.279995,522.546066,936.982873,520.954868,941.802354,530.059981,944.890163,536.325237,945.251835,541.048110,925.569628,550.596357,941.861539,552.006676,931.429453,565.302312,942.773082,562.054597,897.600243,623.716621,907.674865,625.153283,923.052052,612.287253,925.560564,617.452192,925.543731,627.040540,928.257284,629.818059,946.738435,484.231306,936.661585,459.712230,949.500209,502.952140,945.150223,497.574171,931.125585,475.763101,950.058157,518.167126,944.433331,515.250945,926.718070,504.002434,937.138368,523.291012,938.141817,532.503714,944.351182,541.048110,946.664072,546.754554,941.573366,555.851457,935.809635,569.011181,947.659959,562.547344,950.443518,563.287459,941.368744,585.866990,931.533688,616.262652,946.054610,588.323290,928.168755,647.837372,946.808850,597.630427,950.919100,476.705628,944.796785,455.616611,931.847908,413.364536,943.510166,470.102662,951.951613,505.537110,943.769908,491.021503,949.149628,511.775661,953.564825,525.710043,945.604653,522.870404,941.126239,529.722257,950.664992,541.048110,942.616036,551.629799,941.597868,563.228652,945.601662,568.319151,951.901573,564.822091,947.204951,582.495570,953.674073,571.396822,949.453323,591.213010,954.040802,580.047591,951.344730,597.042894,953.849894,590.751063,947.897880,382.180722,956.172752,472.467920,959.016785,502.817783,954.576980,476.548567,955.053800,488.620890,956.753749,505.850124,954.579865,504.202756,952.576785,507.410778,957.765861,528.991145,957.813086,535.066806,947.659453,541.048110,957.430826,547.411297,957.887315,552.862405,949.279568,584.567346,958.974262,560.333197,958.171395,569.164847,956.840648,582.764812,958.704993,576.680038,948.752450,661.312197,953.986240,629.287513,953.553464,643.415391,963.800290,488.919082,963.800290,440.969842,963.800290,501.485462,963.800290,510.257330,963.800290,501.733200,963.800290,499.516120,963.800290,523.389022,963.800290,522.963814,963.800290,526.087204,963.800290,535.609462,963.800290,541.048110,963.800290,546.163005,963.800290,555.818870,963.800290,557.445514,963.800290,567.632495,963.800290,573.582498,963.800290,569.837555,963.800290,615.657295,963.800290,590.627524,963.800290,636.620325,963.800290,594.423514};
	std::vector<float> m2v = {869.379619,446.720489,832.541939,418.661045,885.026004,472.844342,892.179822,483.808200,847.775381,456.047026,897.688198,497.016817,888.176809,495.718737,872.292158,492.291869,885.279028,504.440966,896.922796,514.323475,791.866969,483.793482,848.931220,510.446545,846.240284,517.559279,895.949673,532.010276,763.809184,527.728509,886.895398,541.048110,852.741332,548.444744,871.994738,553.276787,885.241574,556.744370,893.832496,559.687801,894.002674,564.291054,901.712801,474.591357,898.258463,475.570873,856.245593,441.274313,889.838611,477.714860,854.556277,455.298116,881.393440,482.244082,808.210566,441.124714,801.511936,448.403297,900.105335,509.232017,901.487681,514.369024,899.353176,518.053966,834.300128,504.084526,898.599184,527.090213,868.686255,527.473781,894.973630,536.136765,828.204854,541.048110,899.415479,545.642493,867.495807,554.792335,862.950693,562.637441,827.376614,579.987891,877.946055,571.680120,904.596725,472.803624,864.787136,434.523641,900.523365,477.833543,890.057727,473.045133,869.644153,461.456046,858.181560,459.882998,858.647286,468.321618,811.022083,447.123404,857.562998,483.899788,831.759777,480.166392,897.111617,515.423897,846.471761,504.982601,878.523302,521.388198,841.891255,522.311357,896.848223,535.903026,816.374200,541.048110,748.034674,557.629109,856.980058,557.465797,798.416731,579.175935,750.845832,606.507986,862.780787,579.863475,904.401559,466.872867,825.675515,380.061345,805.717390,369.960405,812.809338,390.205957,818.721617,408.190384,881.617857,472.630240,879.114897,477.596657,885.450911,488.866665,873.071206,488.174968,870.095927,494.242100,901.572627,515.145469,866.105462,508.515259,886.514869,521.745796,861.548311,524.022908,874.525552,533.615880,867.346859,541.048110,817.389347,553.236998,820.720812,564.871189,764.560472,590.808978,875.731827,570.375334,882.303647,574.971581,890.420149,441.082892,791.321440,321.745904,907.413082,474.474354,898.391897,469.763817,894.098467,471.414977,902.555499,485.425896,875.379031,468.774738,845.972699,455.439765,896.559923,498.300953,907.840570,510.554706,892.367579,508.610694,901.604873,518.453883,902.718446,524.405842,897.421441,528.991122,890.383612,534.380444,823.636103,541.048110,779.155133,557.817491,892.692770,553.964009,876.319032,564.883123,912.218642,559.786588,820.094662,606.304478,897.534401,441.747232,862.222327,398.979106,848.422540,391.204848,917.258852,485.253423,835.159779,399.682997,912.119884,489.418634,876.591716,462.637741,830.180104,434.257305,878.676300,481.520038,914.802603,511.678469,879.174956,498.777141,917.432492,522.519269,909.780224,524.858061,903.758478,529.051581,916.531951,536.325934,875.895062,541.048110,883.708169,549.049429,906.833409,552.430258,862.154605,571.511765,873.441141,577.156151,907.413843,569.213550,902.548816,439.062923,923.588160,478.557551,888.177182,431.922378,908.383225,467.231506,920.283734,487.913622,902.824305,473.363783,848.376078,425.737646,917.626663,500.045333,895.703944,488.136480,894.517324,494.904984,853.442511,479.798652,868.564188,498.762666,889.619482,516.345542,908.910994,528.862509,912.355024,535.337603,886.165841,541.048110,913.304204,546.653257,867.633691,562.397405,908.074716,559.604996,898.502217,570.040876,885.451942,584.532075,920.252735,459.476910,916.987212,459.205956,911.068614,455.443581,919.557803,474.749780,926.796698,490.218312,885.103074,442.773532,873.914275,440.025996,886.011218,463.335697,866.266953,455.790542,869.433493,470.342760,922.360907,515.174019,879.891037,499.134829,846.428336,497.077003,875.790602,519.067371,926.266412,536.360999,889.698911,541.048110,908.763554,547.920922,928.134332,549.955813,908.862542,561.629463,911.697355,567.073904,879.401245,593.745530,905.409421,416.048125,914.834112,443.212263,911.746206,444.471508,931.210821,485.235506,924.564843,479.453168,922.899094,482.675411,881.230729,434.991865,877.206582,442.181399,902.894147,480.201989,845.591705,439.826316,917.043277,507.683157,905.566267,507.804319,931.720698,527.313262,925.652504,530.159484,872.065222,527.956015,901.364309,541.048110,920.377127,547.245306,913.353400,555.447303,883.986927,575.220128,888.286070,584.156568,883.501254,598.348041,937.175106,474.550746,922.098891,443.840735,937.394057,483.890989,901.200125,415.971161,937.299810,492.511776,933.152436,490.018692,893.717155,436.027006,932.581832,499.464520,914.185216,483.220900,921.757617,499.046869,896.409086,484.944117,928.751763,517.705452,932.081629,525.204409,889.451252,516.289520,867.375678,524.993179,924.638838,541.048110,929.567674,546.747923,931.333510,551.859705,929.277012,558.292738,921.451729,569.252662,918.324329,578.907398,940.448613,471.062116,919.456766,417.008600,930.181438,453.725234,931.138980,462.738215,920.753499,446.438496,941.219371,495.930778,928.464858,477.507012,939.652769,502.450151,928.242924,491.316856,935.780482,507.457476,922.626636,499.915032,939.751789,521.828269,936.583000,524.733829,939.382215,531.290505,913.396115,530.977209,940.630396,541.048110,881.770137,557.437973,937.534956,551.543890,903.676117,577.087063,891.624995,598.731444,939.127132,565.696953,936.985386,440.591317,936.258065,444.745321,914.316452,380.384125,905.067582,365.023625,920.436782,421.915981,929.165729,454.547036,937.847255,482.711327,943.689707,500.866581,945.485613,509.029010,937.116674,501.062130,944.661436,517.148118,943.144184,520.412360,914.564325,504.157527,932.203793,525.265430,917.650927,529.522139,936.191857,541.048110,898.399607,557.382168,942.771374,551.552206,939.637540,559.152313,936.643244,568.178393,913.469347,603.899789,934.771384,396.046617,950.257611,477.911222,943.110043,451.478728,942.625466,456.432282,935.336086,436.782217,936.883518,451.413957,949.833826,499.190010,948.483739,500.244225,948.687776,505.820329,949.839745,513.154536,947.749965,514.323931,946.962309,518.619593,912.780611,490.078710,938.980529,524.517909,949.958519,536.438733,942.972515,541.048110,939.017355,549.300947,944.565829,553.858447,920.908738,583.897394,940.545727,572.023638,947.601148,568.020074,950.596936,442.120545,939.297298,369.696193,941.549393,396.559810,954.623747,486.043113,953.197706,482.791366,953.249270,488.344997,950.496558,481.240313,952.344817,495.271375,948.165951,486.381849,952.535058,507.285719,952.023844,511.636009,933.495025,480.497311,953.351242,525.389985,944.996348,522.262699,937.340341,527.831173,954.166610,541.048110,950.981605,547.451136,951.554409,553.281923,937.698619,580.162032,943.222895,582.162343,954.952356,563.146147,958.859609,467.010927,959.081704,475.053006,957.942609,464.973296,958.537261,477.954006,959.089865,489.284503,952.749003,430.644147,958.214139,490.822299,953.065952,455.258035,958.176683,501.721655,958.290358,508.021096,956.258005,503.373851,958.907878,521.497747,958.494771,525.147240,952.681115,518.831674,956.105127,533.360530,949.477477,541.048110,952.202592,552.634379,957.407138,553.821813,954.917569,567.670010,958.735938,561.285555,958.347842,568.283486,963.800290,282.306789,963.800290,466.580645,963.800290,386.156865,963.800290,464.359218,963.800290,492.173660,963.800290,370.013068,963.800290,471.933653,963.800290,481.135679,963.800290,439.732310,963.800290,498.284986,963.800290,471.315661,963.800290,518.985407,963.800290,514.633158,963.800290,526.211820,963.800290,533.800967,963.800290,541.048110,963.800290,549.290634,963.800290,549.843956,963.800290,558.939407,963.800290,600.667485,963.800290,598.060497,972.001753,418.147401,970.793891,443.234185,968.573402,479.058803,973.300334,427.159929,970.232502,470.363500,968.224856,496.846056,968.430623,499.416176,970.505274,487.461102,969.300035,502.587833,968.527932,512.710209,968.437456,517.885129,973.357956,502.855123,969.284891,524.610521,971.892444,524.879751,969.056864,535.796717,980.340945,541.048110,977.824509,555.058509,973.984055,561.395569,973.357049,569.690134,973.360811,579.252509,972.682781,585.416797,975.177143,455.805801,981.901029,414.467799,973.334806,479.134831,976.235914,466.507898,985.593978,421.300950,972.962416,495.282627,976.713281,482.996917,988.531507,442.220731,981.577832,478.888030,980.907899,489.775860,976.766933,508.663448,975.224631,518.221945,978.618239,518.843090,982.459876,522.406912,974.560184,535.673465,972.704527,541.048110,978.752905,548.517050,985.304899,562.531527,975.629445,558.774357,987.542611,588.485956,975.126400,569.335482,983.127440,444.507594,992.321175,408.081812,1011.793410,333.282873,994.251441,419.363542,981.576228,475.933901,993.858281,440.953544,985.780582,475.172217,979.154750,500.143233,991.099632,477.412418,997.820466,473.074810,983.504572,508.240003,995.580398,498.716391,997.106068,507.775154,991.098233,522.867416,981.648034,535.104725,988.691505,541.048110,978.989003,546.106025,985.318427,555.379397,978.438610,555.672004,982.481362,565.931659,978.724534,565.897337,1027.514105,302.356761,994.322270,434.326454,982.937046,478.914943,1000.711209,430.424477,998.800043,444.893640,991.993005,470.635781,1000.694986,458.116851,1008.714772,451.307670,987.940767,498.843908,987.751353,505.156920,1028.398444,460.379993,989.279772,515.593737,987.453056,523.326018,1021.889551,512.032103,983.104401,536.226838,986.315495,541.048110,991.637449,548.000541,984.180646,551.228246,1023.963871,586.126328,1003.046721,580.255865,1004.774330,592.215186,989.896036,462.838022,1019.502243,385.236342,988.555440,476.748148,985.818073,488.257506,996.603094,468.953060,1005.388124,457.954409,985.897957,501.311507,993.975107,492.815981,1001.247120,488.674212,991.022887,508.413186,1014.278592,490.619554,989.401401,520.587404,1000.766790,518.890068,991.157113,530.116165,997.064322,534.401860,996.366772,541.048110,987.814870,545.846293,1017.138841,562.362505,994.816121,559.639270,1016.935980,583.514771,990.512329,567.733825};
	//These are noisy
//	std::vector<float> m0v = {900.017361,477.121030,876.347218,461.759167,914.348704,499.508025,915.886391,507.219712,886.086559,496.340649,919.675257,518.231038,912.611234,521.808437,903.728954,524.262959,911.648037,531.284319,918.562606,536.856246,848.837678,541.209909,887.190438,547.807977,885.411774,556.031370,919.416221,555.011823,830.037186,594.138919,913.577422,567.010523,889.144563,586.524588,901.014426,581.873761,912.293441,582.618163,916.872989,583.898017,915.647310,587.479264,923.353728,497.220817,922.878590,499.130928,893.507148,478.594926,915.753989,504.843557,893.808622,493.910677,909.730123,511.641573,864.206402,496.407025,859.108910,504.974801,923.075468,531.553121,923.116640,538.238396,924.188222,541.895761,879.057319,550.156118,922.417484,550.955400,903.649354,561.873934,919.708361,560.503360,874.870892,588.578868,923.298417,569.625919,901.177112,587.982927,899.181496,598.819517,876.646015,629.693846,909.059299,603.367826,927.271775,496.455888,902.805343,472.456192,922.960272,501.285017,919.488607,501.737373,906.143440,498.479729,898.303085,499.108523,900.190426,509.154463,868.505763,504.321532,898.391363,523.722219,883.263897,531.535395,921.680629,540.850623,890.885922,549.629225,911.281814,553.412771,891.587305,570.401170,925.123825,560.618717,872.929898,597.365819,830.389737,637.865766,898.276191,598.512457,862.485710,643.809178,833.104053,689.801029,901.129472,619.617735,929.573817,491.345099,882.401170,437.850723,873.698417,436.273725,877.087525,454.129449,878.959891,466.832661,917.540731,505.652203,913.441208,512.314083,915.892165,523.371117,910.729868,523.602848,908.869405,533.344607,928.541190,538.514570,908.062076,550.287142,919.357090,554.816261,905.848031,567.231315,910.285352,571.429058,907.410813,581.284993,877.968386,613.950650,880.404646,622.832979,848.840356,672.258059,913.085654,608.283635,916.917977,608.076685,924.355689,474.339787,869.096655,397.533839,932.413897,501.367689,927.928078,499.879173,925.114540,503.275705,930.273442,513.699287,915.271271,507.184422,901.240342,509.043421,928.694660,530.482606,932.009366,535.796940,924.837574,541.673527,930.050218,547.157013,931.785746,552.012052,928.024449,559.820529,923.041431,567.739460,886.193464,602.574856,863.560378,642.313687,925.775956,587.283784,915.974377,604.646393,935.300062,583.707033,886.897571,672.473643,931.001956,477.261369,914.736688,448.624460,907.265722,448.869610,940.954841,508.455422,899.021355,462.972092,935.730600,516.015516,918.707467,506.979162,896.898808,501.140435,920.921558,525.190004,940.495351,536.923797,921.463606,541.894462,939.325545,546.995493,935.988505,552.455165,932.758056,558.615232,939.688459,559.016477,920.382973,585.109133,923.711666,588.731931,935.214937,581.804670,912.835848,623.375651,919.138252,623.441075,933.915696,596.841581,937.933742,472.288877,946.554424,502.202817,928.791053,474.451095,938.069538,496.394700,944.982307,511.386896,935.393228,506.556441,914.036405,488.912065,944.254537,526.806274,932.556286,525.274956,930.470564,532.907174,915.646909,541.254650,920.860932,550.963618,931.911891,556.179508,939.002902,558.660321,940.005970,562.955364,928.601434,583.187766,941.350776,575.122713,921.682721,614.557446,938.684420,590.582504,933.690044,606.401347,928.114023,627.540999,946.923562,486.007834,946.224776,488.455580,943.783044,488.055848,945.644125,503.013254,950.073048,513.639246,933.521821,491.883651,929.342181,494.797818,935.341528,511.475953,927.246144,516.313845,928.068978,528.914132,949.041048,541.024254,932.682873,551.925392,920.290575,571.505822,929.155087,575.176408,947.851738,558.918746,937.273837,586.641150,942.763491,581.603701,951.612248,571.190758,941.439254,597.189046,942.937135,599.817585,931.725574,645.748123,946.880916,458.560054,950.980477,479.741229,949.750285,482.601160,956.425021,507.736680,953.234681,508.379413,951.598005,511.897462,939.049208,494.882283,938.586757,501.487912,947.542420,524.667366,929.569878,523.858993,948.639889,542.305094,947.839241,549.050498,953.025989,549.046477,954.418413,557.261452,938.358274,594.273073,945.327813,585.154131,951.555943,578.812088,947.021435,590.797786,941.014921,631.206530,942.087838,639.072018,943.004446,656.109962,959.314493,497.762238,955.139217,478.809349,960.509256,505.656726,953.790155,467.047457,958.903211,515.090359,957.667878,514.353640,951.308908,492.412181,958.617333,524.744379,955.641858,524.051412,958.137981,533.764677,951.837381,541.410269,957.518811,546.509133,957.319178,549.800097,951.007472,579.023463,947.213229,604.854929,956.521066,572.824219,957.044717,576.524484,958.583271,578.219274,957.437173,585.037850,958.013454,604.360306,955.298011,619.043833,964.520356,495.446064,963.409753,461.122960,963.122853,487.228418,964.799850,497.117483,964.443691,489.191314,962.652867,518.405311,964.429137,511.209386,962.068113,525.319793,964.823365,525.867997,962.686008,537.057918,963.638281,541.885862,964.413961,546.610621,964.735423,552.349257,963.096843,556.679782,964.207851,580.968302,963.330364,564.512475,963.124637,640.364985,962.782293,577.848879,962.764189,635.781254,963.376384,672.719024,963.938577,590.951726,972.246317,473.414033,969.649263,478.705335,976.346097,442.082283,978.264192,439.084752,976.705749,475.565488,971.953572,498.598893,969.427751,516.180928,969.506068,524.968276,968.448395,531.289373,970.744884,534.799948,967.233121,542.467042,970.977049,544.422742,975.683145,565.350703,972.651945,566.295071,974.393372,587.906166,969.514316,575.455994,980.578004,639.467149,969.562919,577.799802,969.946726,590.197778,971.304752,602.966883,975.210366,665.190669,983.712737,444.770889,972.912054,502.050176,978.731978,484.590989,977.751252,490.473861,981.960068,484.556576,982.341535,496.496220,973.330650,525.159351,973.728071,526.634654,974.205790,532.960538,972.514094,537.090427,972.487349,539.653707,974.124378,546.322957,998.455436,575.028325,981.673005,564.562744,971.539332,559.526452,977.868436,575.936085,980.580866,589.956822,976.635498,584.800963,991.696794,656.108396,978.943796,610.895421,974.313703,593.814927,982.954244,475.576020,1000.474981,431.323300,996.594085,452.973611,977.478672,508.879579,979.249418,510.379508,978.802165,516.337781,984.318273,514.084641,980.733139,523.735334,987.705457,526.202961,980.432051,536.446062,983.496858,540.937438,1009.840384,555.580429,980.217237,550.223983,990.859617,568.724570,1004.885606,593.959565,978.582965,565.859336,983.214383,579.336426,982.043996,583.362361,1003.795930,647.214932,993.950656,632.670970,977.611564,583.418536,985.684297,490.655470,981.829353,498.050633,985.978557,494.328959,983.730172,505.803499,982.371437,513.042142,1006.913017,485.485739,985.728117,517.511692,1006.594175,509.116109,986.058973,530.276465,985.354638,536.281126,995.286171,541.658956,984.430210,545.664675,985.503277,550.497617,1007.591277,573.584129,994.111641,572.416223,1019.832454,614.094703,1011.086392,612.513432,989.497475,586.213928,1000.855119,612.173797,983.837478,585.880254,985.143953,596.305326,1050.063701,368.923718,989.037707,493.365307,1025.277427,446.539181,996.730556,496.292769,984.321445,512.056261,1050.026323,454.608527,1002.670460,511.090059,1001.874683,519.616520,1037.429730,511.819896,1000.340830,535.798363,1030.621949,539.798947,992.479286,546.131194,1006.804281,559.082533,1001.119709,565.604050,999.643027,570.553016,998.316576,576.527892,1004.017119,591.856852,985.927321,571.346837,992.623050,589.445076,1036.691904,676.436004,1021.147288,655.093242,1011.636917,456.801488,1006.020217,476.047286,992.406329,502.842253,1020.809974,474.676198,1001.724751,502.337981,990.103402,519.732484,991.068784,521.393412,1002.746516,519.582660,997.810284,529.354867,991.700304,535.647777,991.122642,540.243265,1022.085955,550.165806,997.610795,551.496042,1012.094221,565.962077,996.982195,563.032191,1064.520183,623.662268,1047.316767,625.431967,1023.800547,613.260493,1019.803473,617.778324,1021.011719,627.055632,1018.745172,630.476982,1003.676217,485.273041,1027.403987,459.931892,997.675847,502.500572,1007.463721,496.800627,1038.082208,474.906939,995.189500,519.065196,1008.604200,516.247753,1051.149853,503.522398,1025.100625,522.886686,1022.467960,533.722741,1009.675229,541.010487,1005.785966,546.990617,1016.799728,555.343501,1028.698482,568.356594,999.806498,561.998898,994.243702,563.079973,1015.706830,587.099591,1038.474963,615.592058,1006.899337,588.040200,1047.090233,649.301007,1003.158762,599.176741,1015.143294,477.553490,1038.399754,455.576840,1092.503672,412.582394,1043.845090,470.253212,1011.341593,503.955477,1042.583761,492.107371,1022.992383,511.841148,1005.221805,526.469503,1037.005905,524.046641,1055.013121,527.642868,1015.960596,541.624277,1047.950911,550.540615,1054.030864,564.072989,1036.101498,567.251617,1013.190907,565.484606,1029.992359,581.204666,1005.224758,573.069221,1020.678544,591.456385,1003.529073,577.683085,1014.106175,597.221332,1003.246690,592.684268,1107.554287,383.722073,1034.275627,472.463529,1005.500074,503.871140,1046.949668,476.551126,1044.572932,489.225075,1026.682873,507.872493,1047.206620,504.377540,1064.426041,508.108959,1015.444258,528.799460,1018.120924,534.493538,1107.729341,541.696865,1019.972593,547.060863,1017.174644,552.243825,1095.533411,583.886370,1008.504893,559.775284,1014.181106,568.314416,1025.720984,583.632193,1008.339929,578.389200,1098.138710,660.667423,1053.021250,630.399393,1057.727211,643.868045,1015.689857,487.569342,1075.233976,441.582138,1013.687267,503.375664,1010.203680,510.678722,1030.574846,502.570637,1046.759965,497.248495,1007.620961,521.261963,1023.611531,523.492087,1038.492078,527.444793,1015.181267,536.500070,1063.316886,543.220036,1015.032078,546.176933,1039.104409,554.589298,1017.006331,558.239489,1032.812684,568.581198,1029.505775,574.097747,1011.531919,569.663595,1070.733609,618.093846,1024.132705,591.046380,1070.481553,635.603371,1017.565763,594.640213};
//	std::vector<float> m1v = {837.119084,478.100004,787.469968,461.518276,859.007921,499.607638,867.229254,505.700885,808.443623,493.690119,876.161747,519.803274,862.684293,519.497801,841.471680,522.739439,859.060361,530.380085,873.765251,539.588459,734.447111,541.516679,810.612712,550.070172,807.080577,556.979955,874.913679,552.980705,696.659990,593.710467,861.116949,566.589610,815.277267,586.202031,840.642372,582.929642,860.833574,584.333663,871.644312,585.581953,872.639043,587.055333,880.398732,497.336986,874.838700,500.268843,818.858715,480.752401,862.274575,504.582113,814.209897,493.893480,851.506243,511.732676,751.878469,498.472886,742.247614,506.711478,878.077247,531.461873,879.588229,536.722570,874.652246,540.919848,789.997665,549.287691,873.869298,550.469452,834.140712,563.140525,869.896975,559.126161,780.036508,588.964936,874.359407,569.222555,832.953915,589.177099,825.835966,599.406092,778.375566,629.492332,846.078272,604.337049,881.374234,495.611456,825.910597,469.965188,878.858175,502.217685,860.650470,501.353467,833.001469,497.957317,816.733293,499.804198,817.513940,507.622934,751.178982,505.689682,817.726591,522.902920,781.550422,532.563213,870.836676,541.567025,801.047870,547.446121,846.017586,553.184348,794.175487,567.885594,871.137561,562.233476,758.364787,597.528290,663.873344,641.466085,816.294456,598.265823,734.716510,642.258043,668.592236,687.758752,824.434735,618.342774,879.603296,492.461438,768.119990,437.076976,739.908173,435.989810,750.151286,452.467071,757.256901,469.499973,846.953262,507.083977,841.877757,512.945546,854.259503,521.110398,835.147195,526.769414,832.310478,533.367283,876.877823,540.993493,824.007511,548.872335,854.560582,554.051487,818.850793,566.564093,837.843883,570.674630,824.962400,581.059585,755.557543,614.969808,760.318043,622.747785,680.256362,674.077310,840.671860,607.356996,848.558796,609.577225,858.442675,476.630104,712.486626,398.209907,881.696392,499.863915,868.277291,497.687065,860.918715,502.692259,873.684219,514.747065,836.619836,510.372039,793.148367,509.963457,867.385482,527.135718,884.581234,535.710352,859.111984,541.026449,873.428024,546.283928,875.242661,550.562454,866.984301,560.257697,856.614305,567.994436,759.057298,604.081419,694.383286,643.461322,860.251972,587.068113,835.971840,604.573642,887.394394,583.518318,755.772963,671.153910,865.534019,474.702396,812.664811,449.300334,791.632866,447.860006,893.241255,508.298450,771.680015,463.983241,885.822054,515.373882,831.374472,506.093534,763.740711,502.605799,836.048718,523.760836,890.905926,536.575268,838.576396,540.587427,896.174287,545.756018,883.615040,551.774031,873.428240,558.127957,891.080406,560.288276,832.040324,586.626768,843.917062,588.363551,878.698805,582.552141,810.796640,621.174660,828.273877,621.072474,879.583738,596.398358,867.291901,472.703442,901.547463,501.209279,845.671584,471.987129,878.060104,498.664167,897.069158,513.740942,869.945628,508.927226,782.075379,487.782655,890.560343,524.212273,858.577197,527.494631,855.354657,533.442635,792.835428,540.842536,815.184309,550.426416,848.790922,557.997094,876.721454,558.590129,884.118168,563.778660,842.809120,584.556033,884.769447,574.910275,813.705037,616.156908,877.709854,590.689578,863.076517,603.983241,842.720330,628.663050,893.228454,486.276373,888.774948,491.282965,878.477212,489.506464,891.469337,500.518028,904.021821,512.908671,836.156838,491.847835,816.365309,496.296310,837.708722,511.456160,805.760024,517.254883,808.337409,528.893530,894.829580,541.656818,827.867791,551.009709,771.795796,571.782913,819.533413,573.662359,903.802669,559.304877,845.095412,586.740982,874.280327,581.065850,906.551739,571.638629,873.474573,594.782403,878.756977,599.617371,827.438493,645.735099,862.575916,458.112905,879.370562,479.151457,874.506362,482.664570,908.482603,507.939242,898.387408,507.361080,893.403721,511.694727,823.719701,493.844626,816.346796,504.113228,861.077843,522.487092,761.303002,525.585956,884.160930,541.231787,864.278925,550.998703,907.210984,550.373282,898.976748,558.169950,807.630163,590.313454,857.764210,585.757756,888.353300,580.170224,877.625602,592.143148,827.695035,630.728592,832.721237,638.992083,826.765275,656.366584,914.673950,497.285839,887.463717,479.305285,915.325056,507.034160,848.496459,466.847630,915.485200,513.283390,907.113922,516.081878,834.439327,495.326163,905.934198,525.089903,872.157669,523.300973,885.876147,533.682739,838.889800,543.257459,901.964691,546.059441,905.644573,550.995126,826.296403,576.323693,787.969698,605.647296,891.853175,573.860504,899.587118,573.906707,903.912782,579.758901,899.599548,586.825662,885.743451,602.958360,880.652416,617.683846,917.383788,493.793763,874.877966,462.366498,895.928762,487.032614,897.897249,492.754149,877.328503,489.849046,917.965457,518.627524,893.764849,513.270103,914.275151,525.266980,894.208765,525.261221,908.121510,534.891014,879.641596,542.059557,914.601824,546.613104,910.874252,551.396864,915.452180,556.194455,861.413204,579.912250,917.490026,566.323208,798.801820,638.995072,910.297862,578.521132,841.328113,636.834630,818.878568,670.943314,912.339751,590.806773,903.018087,475.829895,902.620846,480.094016,852.567041,442.381328,832.574648,438.418306,868.502621,476.659058,886.327419,498.590695,904.851644,514.724597,920.515245,526.547187,922.254890,531.723643,904.127669,534.162531,919.899125,540.031161,917.330543,546.199723,852.755535,567.380668,891.239201,564.699518,860.152141,587.449739,901.568615,576.809974,816.874971,640.198277,917.033900,578.661590,910.727548,589.549180,902.808327,602.499446,850.711312,666.439733,885.425224,444.060367,926.764907,498.936825,909.846582,486.585518,905.893679,491.990187,887.671182,484.471196,893.442565,495.134669,925.660001,521.665884,924.488510,526.875777,922.758120,530.808914,926.563772,536.558668,921.800379,540.736295,917.819550,546.993032,828.548615,574.318719,897.810718,565.933189,924.931528,558.907269,907.701027,576.524266,897.633171,591.329691,912.395184,583.669096,848.609574,654.454686,901.497721,611.620049,921.231259,593.307570,916.809693,476.034264,876.945738,432.297732,886.355222,451.076010,931.425950,509.938386,926.181695,508.770553,926.216205,513.194157,917.524890,515.155361,924.546275,525.197646,908.345358,525.873479,923.963221,535.396476,921.730973,541.360116,858.632581,556.632178,927.812128,552.501251,897.678017,570.061280,870.702321,594.066177,930.069989,564.657276,920.072011,578.713590,920.492931,583.890145,873.217624,644.502322,891.519068,633.393776,933.323391,586.414729,936.146029,492.571175,936.704908,497.897887,929.265359,493.824678,933.182618,503.619719,935.310587,512.856448,897.853256,484.408790,930.294092,517.934577,900.323544,509.644825,927.842852,528.804324,932.956375,536.635581,918.584042,539.469448,933.677461,545.872204,933.501261,551.083968,897.523981,573.110878,918.503946,570.761949,877.727064,612.694534,894.074490,609.698068,923.870198,586.253443,910.835259,611.967143,931.858219,586.678583,931.048926,596.616942,877.858993,368.127265,938.075554,490.864046,904.896099,446.635879,931.592801,494.848071,941.413743,512.363279,877.133351,457.266492,925.220385,510.003255,927.040043,519.439806,890.988401,512.166297,928.695745,534.742649,891.408130,540.821141,935.028461,547.611911,920.246462,557.738326,928.206665,562.491970,929.279073,569.942852,927.391047,576.339877,922.227549,590.705362,941.558716,572.784426,934.042189,587.649900,888.026387,675.015956,906.873888,655.527994,930.812878,458.806504,935.448862,479.980321,945.025292,502.879284,925.869489,473.713918,936.663966,502.150983,946.754571,518.324680,945.385741,522.382078,938.038223,521.888360,943.405762,530.007887,944.814465,536.191209,946.160235,539.803403,928.672286,550.458237,942.469883,551.111056,932.063333,567.806437,943.866957,561.924092,897.259330,622.229702,907.576884,625.382930,923.031869,613.214291,925.228446,616.413219,925.345796,627.373727,925.528110,630.598241,946.087248,483.690089,936.724941,459.566137,948.661113,502.615672,946.490355,498.152592,930.983276,476.132620,950.784728,517.965332,944.230028,515.442489,925.724495,505.190619,936.988070,523.308539,938.889896,534.309565,944.503804,538.965198,947.591316,547.129751,943.400102,555.638754,936.237051,569.306474,947.184092,563.676096,950.763590,565.149949,939.702043,586.537351,931.365399,617.240120,946.212177,587.644415,926.298485,647.991168,947.246326,597.247471,951.971823,476.968956,945.889802,457.674654,931.048787,412.867427,943.165217,469.327725,952.779811,504.891149,944.184491,490.667529,948.514106,511.375209,953.704014,526.283489,946.127084,523.093931,941.052196,529.788735,950.167147,540.817807,942.809136,552.061543,941.063920,561.753814,946.672216,569.451214,952.673270,564.567871,946.756448,583.663697,952.250620,570.880397,949.854014,591.387255,954.311767,581.500477,950.281297,598.020755,953.419616,590.067036,948.184843,381.932108,956.035753,471.341578,958.360269,501.701481,954.302617,477.399163,955.859949,488.444556,955.639215,505.774015,954.804896,503.929141,952.139612,507.427710,959.695434,529.526111,958.114438,535.631808,949.376063,540.937171,958.240973,547.424816,961.007253,552.830193,949.856276,583.899938,958.794777,560.518841,957.604982,569.998412,956.778344,580.206824,957.803106,576.557620,949.725152,662.692005,954.273928,629.740513,953.777418,641.766188,964.709727,489.911105,964.349185,441.060302,964.913583,500.946519,963.107295,510.311742,963.567096,501.094793,964.479790,499.406174,964.467657,523.737920,963.760990,521.668433,965.366455,526.079846,963.798959,536.038015,963.333467,540.511475,963.576694,544.583470,963.877662,556.612078,963.965265,556.520597,964.752234,566.379740,965.272937,573.862024,962.550678,569.247626,964.320028,616.578086,963.244573,590.530882,962.098843,636.197164,964.430948,594.085945};
//	std::vector<float> m2v = {869.989149,446.060982,832.287143,419.121359,886.645425,474.003267,893.395837,483.954888,847.276308,454.399001,898.617043,493.953005,888.138531,494.416233,871.040089,492.123958,885.348313,506.198274,898.801717,515.148918,791.783889,483.222912,849.246172,510.629529,844.564020,517.533816,896.145498,530.158693,763.930624,527.114940,885.515268,540.862512,852.933320,549.470220,872.028118,555.839709,885.956590,557.044826,895.553867,558.436633,892.799677,565.579240,903.973500,475.172260,898.566038,473.941528,856.968748,441.217627,891.034265,479.494876,856.452606,456.599509,882.450140,483.961587,808.072612,438.248694,800.920458,451.108094,898.992124,509.504479,903.050526,513.929849,897.507104,518.167365,835.307776,504.703603,897.328440,526.478537,869.303643,526.035602,896.926222,536.934136,828.546011,541.306273,899.176209,545.667005,865.741088,556.209009,863.681435,562.112089,825.051434,579.556600,877.999039,572.345010,904.046798,473.273967,865.052252,435.252712,900.865005,477.416852,889.940153,471.631323,870.897610,460.050921,857.355914,458.900042,857.014196,467.781765,810.066592,448.294615,857.678991,482.940819,832.610720,479.020932,897.394740,515.729566,844.291921,504.808855,879.549654,521.196110,840.832598,522.975748,895.581917,534.598710,815.634989,540.743787,749.764718,557.973005,857.240760,557.916501,799.248553,577.793637,750.224522,606.353165,862.146187,580.302460,904.096334,467.108890,825.786776,380.511532,805.160843,369.140899,810.816945,392.406928,818.885714,407.465319,880.488972,471.208241,879.541801,477.653597,885.036929,488.590651,872.960574,490.085758,869.860220,493.475558,901.855548,516.022736,867.989709,507.046411,886.949320,522.782671,861.204758,523.215296,874.689218,533.359828,867.360069,539.964112,816.529102,553.575695,821.364872,564.732698,764.703306,590.766147,873.671237,569.411140,881.793522,576.808406,889.376059,442.473346,791.998549,321.720204,906.797868,472.916359,898.591047,468.630032,892.475498,471.401977,903.324515,484.885320,875.761258,468.942464,848.218262,456.613727,895.381027,498.170784,907.544382,509.868206,892.524458,509.087632,904.744924,518.784187,901.728838,524.027508,898.257315,527.852666,890.201173,535.165212,823.484562,541.722444,778.433008,557.492898,891.103097,554.159509,877.362587,565.153211,913.353377,559.215547,820.113765,607.230605,895.859101,441.900231,860.885385,400.035694,848.642275,390.905202,916.604693,485.066023,835.800887,402.189250,910.683076,489.831383,876.677358,464.890184,830.929351,433.299812,879.436380,480.479695,915.652290,509.888383,878.760156,498.811753,918.508941,521.230566,910.149398,524.991002,905.052361,527.700452,916.339041,535.741800,875.082580,540.921387,883.332680,549.135712,906.908960,552.109335,861.928311,571.882499,875.434985,576.740643,908.808488,568.728293,903.401915,439.943346,922.457629,477.681975,887.393086,431.336144,908.162185,464.935497,921.084091,487.679436,901.183512,474.230333,847.805722,424.249525,919.030029,501.523385,895.820130,486.736866,894.531544,494.844468,851.940309,480.969821,868.168286,499.500952,889.821505,517.184926,908.463492,527.717125,913.110291,533.644616,885.099905,540.893376,912.551740,546.482845,868.407444,560.939384,907.820538,559.753470,899.488923,569.436646,885.739141,585.147036,921.344575,460.456112,916.958439,460.486020,912.323579,454.602826,919.860391,475.542881,926.747168,491.605427,885.382577,441.355869,874.656304,440.481044,887.001225,462.692015,866.935208,454.902395,869.000258,470.148254,922.818144,513.092115,877.900933,500.380510,846.201137,496.171733,875.697602,519.702903,926.086672,536.581529,888.563840,542.882001,909.533062,546.333172,929.223352,549.711419,907.599610,559.863752,911.190593,567.568739,880.424082,595.019846,906.633834,416.619464,914.773538,442.587208,911.029824,445.221110,929.509370,484.247658,924.857325,478.396917,924.278395,483.043833,880.815646,432.851789,877.891132,441.957762,904.803404,480.232649,846.077262,438.890057,917.708591,510.190030,904.172235,507.863631,930.793366,527.878042,925.406329,530.543643,871.597592,527.406516,900.129653,543.232902,920.792397,546.128317,913.031914,555.450917,884.101326,575.978505,887.325794,584.696196,882.158985,598.746732,937.844323,474.229107,923.372386,442.675676,937.609348,482.306716,900.797523,416.604007,938.592102,491.379736,933.439461,489.906777,895.290375,435.475786,932.578564,498.086445,916.492931,483.789526,921.725529,498.267086,896.618590,486.309735,929.195065,517.322382,932.703530,526.902724,888.494083,517.166043,867.485915,523.821429,924.464363,539.778972,927.501000,547.127063,931.795935,552.233999,929.558893,558.156217,921.020764,570.227726,919.854768,579.814572,942.618252,472.056750,919.395563,416.958355,930.193424,452.179236,931.524643,462.254545,920.895428,446.368138,940.316465,496.019318,930.065121,477.939805,939.359441,503.012212,928.102437,491.562742,935.368918,509.598571,923.613373,500.296594,938.961227,520.787352,937.108594,522.200415,937.618312,530.460525,913.153629,529.167018,940.263025,540.382879,882.897869,557.250969,937.856527,551.913794,905.169307,578.692764,891.308286,599.156064,938.356265,565.877372,937.591128,440.240086,937.460643,445.567350,915.070257,379.924123,904.465295,365.511076,919.275338,421.314206,929.578227,454.457959,938.204748,481.844231,942.912258,502.117420,946.072860,508.735657,936.873426,502.217289,945.108508,518.199611,944.556442,520.577590,913.277596,504.890718,931.791997,523.623148,916.643071,529.838799,934.689186,541.581087,899.147411,556.848663,942.780275,550.487444,939.747652,559.798076,935.271430,568.796385,915.112041,605.709117,935.032412,396.709732,949.494619,477.198120,943.864108,451.709430,940.780753,457.358542,934.465626,436.944583,937.191988,450.987563,948.626799,500.033565,947.638361,501.773979,948.152371,505.052200,949.156660,512.362095,946.572812,515.899592,946.580622,516.743050,911.726524,491.490576,937.986161,526.500535,949.249390,535.541181,943.316188,540.368883,938.309292,550.290041,945.100482,552.811114,921.283358,584.597383,939.867552,572.940220,948.539166,567.587859,950.487699,442.536227,940.634291,369.779187,940.286041,394.924236,954.475775,487.033432,953.789473,482.174507,954.284345,489.553360,951.916352,481.044808,950.590467,494.737701,947.759821,487.607701,951.334567,508.177256,951.783093,510.310146,934.175558,482.007918,954.546804,526.525498,944.107660,522.655750,935.851547,527.452097,954.848652,540.234691,950.970312,546.626005,951.701705,553.098410,937.569347,579.984740,942.850864,581.042175,956.089532,562.789967,958.560390,467.196215,960.224683,475.771137,958.684906,464.304263,958.631837,478.993830,959.535656,489.922807,952.463726,429.918582,956.660218,492.095388,954.699404,455.068150,957.607001,501.892301,958.217750,507.436198,956.297692,503.682898,959.870223,520.610285,958.494226,525.949771,951.688753,519.015643,956.404645,533.071002,949.330496,541.207120,951.969851,550.143690,957.519617,554.662066,955.005334,567.275293,960.042701,561.770800,958.823736,565.670806,963.170801,282.475806,964.785334,465.372873,963.565023,387.053944,964.388441,463.584255,964.100760,492.849226,962.077422,370.845951,965.266261,472.219178,964.603374,482.168122,965.001911,440.103771,962.709594,498.936826,963.098439,471.579011,965.422280,517.937633,963.769092,515.921554,963.267930,527.184853,963.265691,531.942361,965.179443,541.389292,963.898436,547.365979,964.301114,550.095692,965.451576,559.362295,964.460949,598.747391,963.958131,599.347031,971.613031,417.043047,970.099510,442.407549,968.282117,482.305397,975.489579,426.223886,970.026830,469.019393,969.061832,495.792097,969.880034,500.296301,971.922485,487.154776,970.077501,502.481636,966.850109,512.544675,968.228054,517.728534,973.633092,503.105072,968.786089,524.368819,972.481461,525.685424,970.450309,533.753449,979.403182,541.009593,978.876775,554.269125,973.304299,563.117035,972.638705,568.615007,972.983497,578.750764,972.785694,584.915418,974.444542,455.478555,982.464065,414.249309,973.617836,479.641149,976.515029,466.071730,985.392581,422.240423,971.639022,494.453843,979.214224,483.100093,988.918915,441.737920,980.257468,479.388506,980.772238,490.215650,976.071351,509.496319,974.646146,517.112349,979.918768,518.849148,984.302246,523.109961,974.387086,534.432671,971.866220,543.648318,978.998409,548.678244,985.846421,563.125985,977.269201,558.183575,986.997100,588.860509,974.582911,571.152229,981.987451,445.655461,990.618232,408.123098,1011.764332,334.484440,993.814715,420.909189,980.105488,475.341577,992.653634,440.926741,986.469746,473.946431,981.137107,500.865372,991.525694,476.347682,997.799577,472.738941,982.506134,510.110485,994.486565,497.510039,995.651386,508.252592,991.493750,522.880172,982.236278,535.396977,989.419701,541.964495,977.692916,548.306064,984.716980,556.341323,979.168969,553.499852,982.130402,565.582069,977.662126,566.201464,1025.784775,301.757865,993.012160,436.692154,981.669610,480.149083,1001.816714,432.095519,1000.508030,445.456795,991.741822,468.752821,1000.864652,459.781856,1007.189584,450.996974,988.341099,499.074586,986.256979,504.797768,1026.389799,459.400516,990.824254,515.300124,988.807954,523.923516,1022.470647,511.470550,984.022152,535.584914,985.952090,539.933956,992.623784,547.749048,985.428461,550.528595,1025.233866,585.696478,1001.524649,580.300477,1005.762313,593.015690,988.812602,464.607168,1020.489203,383.875296,988.610460,477.087122,984.676831,488.615882,997.235715,468.623000,1005.464379,458.386841,984.788110,502.284915,994.986895,493.266855,1000.378142,489.531522,988.953229,508.208764,1014.902980,489.412496,991.214757,521.582310,1001.345795,520.090383,993.308629,531.500720,996.099287,536.131366,996.355629,540.439928,987.438611,546.354240,1015.764549,562.500116,995.826514,559.846274,1016.832881,583.319594,990.376588,568.519118};
	cv::Mat3f X(1,Xv.size()/3,(cv::Vec3f*)Xv.data());
	cv::Mat2f m0(1,m0v.size()/2,(cv::Vec2f*)m0v.data());
	cv::Mat2f m1(1,m1v.size()/2,(cv::Vec2f*)m1v.data());
	cv::Mat2f m2(1,m2v.size()/2,(cv::Vec2f*)m2v.data());

	std::vector<SlamKeyFrame> frames;
	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose0)));

	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose1)));

	frames.push_back(SlamKeyFrame());
	frames.back().setCameraModel(&camera);
	frames.back().setPose(std::unique_ptr<Pose3D>(new FullPose3D(pose2)));

	std::vector<FeatureMatch> matches2D;
	std::vector<FeatureMatch> matches3D;

	std::vector<std::unique_ptr<SlamFeature>> features;
	for(int i=0,end=X.cols; i!=end; ++i)
	{
		features.emplace_back(new SlamFeature());
		auto &feature = *features.back();
		feature.set2DSection(NULL);
		feature.setPosition(X(0,i));

		feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[0], m0(0,i), camera.unprojectToWorld((cv::Point2f)m0(0,i)), 0)));
		frames[0].getMeasurements().push_back(feature.getMeasurements().back().get());

		feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[1], m1(0,i), camera.unprojectToWorld((cv::Point2f)m1(0,i)), 0)));
		frames[1].getMeasurements().push_back(feature.getMeasurements().back().get());

		//feature.getMeasurements().push_back(std::unique_ptr<SlamFeatureMeasurement>(new SlamFeatureMeasurement(&feature, &frames[2], m2(0,i), camera.unprojectToWorld((cv::Point2f)m2(0,i)), 0)));
		//frames[2].getMeasurements().push_back(feature.getMeasurements().back().get());

		cv::Point2f p(m2(0,i));
		SlamFeatureMeasurement m2i(&feature, &frames[2], p, camera.unprojectToWorld(p), 0);
		matches3D.push_back(FeatureMatch(feature.getMeasurements()[0].get(), m2i));
//		if(i<50)
//		{
//			matches2D.push_back(FeatureMatch(feature.getMeasurements()[0].get(), m2i));
//		}
//		else
//		{
//			matches2D.push_back(FeatureMatch(feature.getMeasurements()[1].get(), m2i));
//		}
	}

	{
		NVSLAM_LOG << "Residuals with perfect pose:\n";
		FeatureMatch *match = (matches3D.empty()) ? &matches2D[0] : &matches3D[0];
		cv::Matx33d rd = truePose2.getRotationRef();
		cv::Vec3d td = truePose2.getTranslationRef();
		cv::Vec3d xd = (cv::Point3d)match->measurement.getFeature().getPosition();
		double res[2];
		PoseReprojectionError2D err2D(*match);
		err2D.computeAllResidualsRmat(rd.val, td.val, res);
		NVSLAM_LOG << "Err 2D 0: " << res[0] << "\n";
		NVSLAM_LOG << "Err 2D 1: " << res[1] << "\n";
		NVSLAM_LOG << "Err 2D norm: " << sqrt(res[0]*res[0]+res[1]*res[1]) << "\n";

		PoseReprojectionError3D err3D(*match);
		err3D.computeAllResidualsRmat(rd.val, td.val, xd.val, res);
		NVSLAM_LOG << "Err 3D 0: " << res[0] << "\n";
		NVSLAM_LOG << "Err 3D 1: " << res[1] << "\n";
		NVSLAM_LOG << "Err 3D norm: " << sqrt(res[0]*res[0]+res[1]*res[1]) << "\n";
	}

	{
		NVSLAM_LOG << "Residuals with wrong measurement:\n";
		const SlamFeatureMeasurement *mref = matches3D[0].sourceMeasurement;
		cv::Point2f p(m1(0,0));
		p.y -= 5;
		SlamFeatureMeasurement m(&mref->getFeature(), &frames[1], p, camera.unprojectToWorld(p), 0);
		FeatureMatch match(mref, m);

		//cv::Matx33d rd = truePose2.getRotationRef();
		//cv::Vec3d td = truePose2.getTranslationRef();
		cv::Matx33d rd = pose1.getRotationRef();
		cv::Vec3d td = pose1.getTranslationRef();
		double res[2];
		PoseReprojectionError2D err2D(match);
		err2D.computeAllResidualsRmat(rd.val, td.val, res);
		NVSLAM_LOG << "Err 2D 0: " << res[0] << "\n";
		NVSLAM_LOG << "Err 2D 1: " << res[1] << "\n";

		cv::Vec3d xd = (cv::Point3d)matches3D[0].measurement.getFeature().getPosition();
		//double res[2];
		PoseReprojectionError3D err3D(match);
		err3D.computeAllResidualsRmat(rd.val, td.val, xd.val, res);
		NVSLAM_LOG << "Err 3D 0: " << res[0] << "\n";
		NVSLAM_LOG << "Err 3D 1: " << res[1] << "\n";
	}

	auto f = cv::Formatter::get(cv::Formatter::FMT_MATLAB);
	f->set32fPrecision(2);

	NVSLAM_LOG << "Before R=" << (cv::Mat1f)pose2.getRotationRef() << "\n";
	NVSLAM_LOG << "Before t=" << pose2.getTranslationRef() << "\n";

	std::vector<MatchReprojectionErrors> errors3D;
	std::vector<MatchReprojectionErrors> errors2D;
	int inlierCount;
	PnPRefiner refiner;
	refiner.setCamera(&camera);
	refiner.setOutlierThreshold(3);
	refiner.refinePose(matches3D,matches2D,pose2.getRotationRef(),pose2.getTranslationRef(), inlierCount, errors3D, errors2D);

	NVSLAM_LOG << "After R=" << f->format((cv::Mat1f)pose2.getRotationRef()) << "\n";
	NVSLAM_LOG << "After t=" << f->format((cv::Mat1f)pose2.getTranslationRef()) << "\n";
}

TEST(PnPTests, syntheticNoiseScene)
{
	PnPTests_syntheticNoiseScene();
}
